<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Pathogen detection from (direct Nanopore) sequencing data using Galaxy - Foodborne Edition</title>
        
            <script async defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>

        
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap-toc.min.css">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <script src="https://kit.fontawesome.com/67b3f98409.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml" />
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html" />
        <link rel="license" href="https://creativecommons.org/licenses/by/4.0/" />

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material" />
<meta name="DC.type" content="text" />
<meta name="DC.title" content="Pathogen detection from (direct Nanopore) sequencing data using Galaxy - Foodborne Edition" />
<meta name="DC.publisher" content="Galaxy Training Network" />
<meta name="DC.date" content="2023-02-02 10:13:09 +0000" />
<meta name="DC.creator" content="Bérénice Batut" />
<meta name="DC.creator" content="Engy Nasr" />

        
        
        
        
        <meta name="description" content="Metagenomics is a discipline that enables the genomic stu..." />
        <meta property="og:site_name" content="Galaxy Training Network" />
        <meta property="og:title" content="Galaxy Training: Pathogen detection from (direct Nanopore) sequencing data..." />
        <meta property="og:description" content="Metagenomics is a discipline that enables the genomic stu..." />
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />

        
        <script type="application/ld+json">
            


{
  "@context": "http://schema.org",
  "@type": "LearningResource",
  "http://purl.org/dc/terms/conformsTo": {
    "@id": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
    "@type": "CreativeWork"
  },
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "Students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "dateModified": "2023-02-02 10:13:09 +0000",
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Pathogen detection from (direct Nanopore) sequencing data using Galaxy - Foodborne Edition",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "identifier": "https://github.com/galaxyproject/training-material",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "The text aims to be as accessible as possible. Image descriptions will vary per tutorial, from images being completely inaccessible, to images with good descriptions for non-visual users.",
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Metagenomics",
    "description": "Metagenomics is a discipline that enables the genomic study of uncultured microorganisms",
    "url": "https://training.galaxyproject.org/training-material/topics/metagenomics/"
  },
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'Pathogen detection from (direct Nanopore) sequencing data using Galaxy - Foodborne Edition' tutorial",
  "url": "https://training.galaxyproject.org/training-material/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html",
  "timeRequired": "PT4H",
  "keywords": "metagenomics, Nanopore data analysis, Pathogens detection, Phylogenetic tree, Heatmap, cyoa",
  "description": "The questions this  addresses are:\n - What are the preprocessing steps to prepare ONT sequencing data for further analysis?\n - How to identify pathogens using sequencing data?\n - How to track the found pathogens through all your samples datasets?\n\n\nThe objectives are:\n - Check quality reports generated by FastQC and NanoPlot for metagenomics Nanopore data\n - Preprocess the sequencing data to remove adapters, poor quality base content and host/contaminating reads\n - Perform taxonomy profiling indicating and visualizing up to species level in the samples\n - Identify pathogens based on the found virulence factor gene products via assembly, identify strains and indicate all antimicrobial resistance genes in samples\n - Identify pathogens via SNP calling and build the consensus gemone of the samples\n - Relate all samples' pathogenic genes for tracking pathogens via phylogenetic trees and heatmaps\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "competencyRequired": [
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Metagenomics",
      "description": "Metagenomics is a discipline that enables the genomic study of uncultured microorganisms",
      "url": "https://training.galaxyproject.org/training-material/topics/metagenomics/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3174",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3174",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3174"
    }
  ],
  "educationalLevel": "Beginner"
}
        </script>
        
    </head>
    <body data-spy="scroll" data-target="#toc">
        <script type="text/javascript" src="/training-material/assets/js/theme.js"></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/topics/metagenomics" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i> Metagenomics
                        </a>
                        
                    </li>

                    <li class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Languages">
                            <i class="fas fa-language" aria-hidden="true"></i><span class="visually-hidden">language</span> Languages
                        </a>
                        <div class="dropdown-menu dropdown-menu-right">
                            
                              <strong class="dropdown-header">Automatic Translations</strong>
            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=fr&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html&edit-text=&act=url">
                            Français
                            </a>
                            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ja&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html&edit-text=&act=url">
                            日本語
                            </a>
                            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=es&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html&edit-text=&act=url">
                            Español
                            </a>
                            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=pt&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html&edit-text=&act=url">
                            Português
                            </a>
                            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ar&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html&edit-text=&act=url">
                            العربية
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html&edit-text=&act=url" title="">
                            And more!
                            </a>
                        </div>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <!-- disable Tess for now
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>
        -->

        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        
        <a class="dropdown-item" href="/training-material/topics/metagenomics/faqs/" title="Check our FAQs for the Metagenomics topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Gitter
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Extras">
        <i class="far fa-star" aria-hidden="true"></i><span class="visually-hidden">galaxy-star</span> Extras
    </a>
    <div class="dropdown-menu dropdown-menu-right">

        
        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.md" title="Edit on GitHub">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
        </a>

        <a class="dropdown-item" href="/training-material/stats.html" title="Show view statistics about this repository">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html" title="Show view statistics of this page">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page Metrics
        </a>

        <!-- link to feedback -->
        
            
            
                <a class="dropdown-item" href="/training-material/feedback.html" title="Show feedback statistics about this repository">
                    <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
                </a>
            
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
            </div>

            <div id="theme-selector" data-toggle="buttons">
                    <button class="btn" data-theme="default">Default</button>
                    <button class="btn" data-theme="night">Night</button>
                    <button class="btn" data-theme="midnight">Midnight</button>
                    <button class="btn" data-theme="rainbow">Rainbow</button>
                    <button class="btn" data-theme="blm">✊🏿</button>
                    <button class="btn" data-theme="progress" >🏳️‍🌈</button>
                    <button class="btn" data-theme="halloween">🎃</button>
                    <button class="btn" data-theme="straya">🇦🇺</button>
            </div>

        </div>

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2022-05-01/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html" title="Version 2022-05-01">2022-05-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2022-04-01/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html" title="Version 2022-04-01">2022-04-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2022-03-01/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html" title="Version 2022-03-01">2022-03-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/" title="Older Versions">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        <div class="container main-content" role="main">
        











<!-- Gitter -->




<script>
  ((window.gitter = {}).chat = {}).options = {
  room: 'Galaxy-Training-Network/Lobby'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

<section class="tutorial topic-metagenomics">
    <h1 data-toc-skip>Pathogen detection from (direct Nanopore) sequencing data using Galaxy - Foodborne Edition</h1>
    

    <div markdown="0">

	<div class="contributors-line">
		
<table class="contributions">
	
	<tr>
		<td><abbr title="These people wrote the bulk of the tutorial, they may have done the analysis, built the workflow, and wrote the text themselves.">Author(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/bebatut/" class="contributor-badge contributor-bebatut"><img src="/training-material/assets/images/orcid.png" alt="orcid logo"/><img src="https://avatars.githubusercontent.com/bebatut?s=27" alt="Avatar">Bérénice Batut</a><a href="/training-material/hall-of-fame/EngyNasr/" class="contributor-badge contributor-EngyNasr"><img src="/training-material/assets/images/orcid.png" alt="orcid logo"/><img src="https://avatars.githubusercontent.com/EngyNasr?s=27" alt="Avatar">Engy Nasr</a>
		</td>
	</tr>
	


	

	
	<tr>
		<td><abbr title="These people edited the text, either for spelling and grammar, flow, GTN-fit, or other similar editing categories">Editor(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/hrhotz/" class="contributor-badge contributor-hrhotz"><img src="/training-material/assets/images/orcid.png" alt="orcid logo"/><img src="https://avatars.githubusercontent.com/hrhotz?s=27" alt="Avatar">Hans-Rudolf Hotz</a><a href="/training-material/hall-of-fame/wm75/" class="contributor-badge contributor-wm75"><img src="/training-material/assets/images/orcid.png" alt="orcid logo"/><img src="https://avatars.githubusercontent.com/wm75?s=27" alt="Avatar">Wolfgang Maier</a></td>
	</tr>
	

	

	

	
</table>


	</div>

</div>


    <blockquote class="overview">
        <div class="box-title" aria-label="overview box">Overview</div>
        
        <img alt="Creative Commons License" class="float-right" style="border-width:0; display: inline-block; margin:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" aria-hidden="true" />
        
        <strong><i class="far fa-question-circle" aria-hidden="true"></i> Questions:</strong>
        <ul>
        
        <li><p>What are the preprocessing steps to prepare ONT sequencing data for further analysis?</p>
</li>
        
        <li><p>How to identify pathogens using sequencing data?</p>
</li>
        
        <li><p>How to track the found pathogens through all your samples datasets?</p>
</li>
        
        </ul>

        <strong><i class="fas fa-bullseye" aria-hidden="true"></i> Objectives: </strong>
        <ul>
        
        <li><p>Check quality reports generated by FastQC and NanoPlot for metagenomics Nanopore data</p>
</li>
        
        <li><p>Preprocess the sequencing data to remove adapters, poor quality base content and host/contaminating reads</p>
</li>
        
        <li><p>Perform taxonomy profiling indicating and visualizing up to species level in the samples</p>
</li>
        
        <li><p>Identify pathogens based on the found virulence factor gene products via assembly, identify strains and indicate all antimicrobial resistance genes in samples</p>
</li>
        
        <li><p>Identify pathogens via SNP calling and build the consensus gemone of the samples</p>
</li>
        
        <li><p>Relate all samples’ pathogenic genes for tracking pathogens via phylogenetic trees and heatmaps</p>
</li>
        
        </ul>

        
        <strong><i class="fas fa-check-circle" aria-hidden="true"></i> Requirements:</strong>
        <ul>
        
    <li>
    
        
        
        <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        
    
    </li>

        
        </ul>
        

        
        <div><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i> Time estimation:</strong> 4 hours</div>
        

        
        <div><strong><i class="fas fa-graduation-cap" aria-hidden="true"></i> Level: </strong>
        


 Introductory <span class="visually-hidden">Introductory</span>
<span class="level introductory" title="Introductory Tutorial">
  <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i>
</span>

</div>
        

        
        

        
        <div id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials:</strong></div>
        <ul class="supporting_material">
            

            
                <li class="btn btn-default supporting_material">


<a class="btn btn-default topic-icon" title="Zenodo datasets used in this tutorial" href="https://zenodo.org/record/7593928">
    <i class="far fa-copy" aria-hidden="true"></i>&nbsp;Datasets
</a>

</li>
            

            
                <li class="btn btn-default supporting_material">


    <a class="btn btn-default topic-icon" href="/training-material/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/" title="Workflows" alt="Pathogen detection from (direct Nanopore) sequencing data using Galaxy - Foodborne Edition workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Workflows
    </a>

</li>
            

            

            

            
            
            

            <!-- Check the GTN Video Library for recordings of this tutorial or associated slides -->
            













  



            
                <li class="btn btn-default supporting_material">


    <a href="#" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span>&nbsp;Available on these Galaxies 
    </a>
    <ul class="dropdown-menu">
    
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/main/topics/metagenomics/docker" title="Docker image for this tutorial">
                <i class="fab fa-docker" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://africa.usegalaxy.eu/" title="Galaxy Africa">
            Galaxy Africa
        </a>
        
    
        
        <a class="dropdown-item" href="https://india.usegalaxy.eu/" title="Galaxy India">
            Galaxy India
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://streetscience.usegalaxy.eu/" title="Street Science">
            Street Science
        </a>
        
    
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.eu" title="UseGalaxy.eu">
            UseGalaxy.eu
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
    </ul>


</li>
            
        </ul>
        

        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Last modification:</strong> Feb 2, 2023 </div>
        <div><strong><i class="fas fa-balance-scale" aria-hidden="true"></i> License:</strong>
            
            <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Tutorial Content is licensed under Creative Commons Attribution 4.0 International License</a>
            
            <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">The GTN Framework is licensed under MIT</a>
        </div>
    </blockquote>

    <div class="container">
        <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2">
                <nav id="toc" data-toggle="toc" class="sticky-top" aria-label="Table of Contents"></nav>
            </div>
            <div class="col-sm-10">
                 

                <h1 id="introduction">Introduction</h1>

<p>Food contamination with pathogens is a major burden on our society. In the year 2019, foodborne pathogens caused 137 hospitalisations in Germany <a href="https://www.bvl.bund.de/SharedDocs/Berichte/10_BELA_lebensmittelbed_Krankheitsausbruechen_Dtl/Jahresbericht2019.pdf?__blob=publicationFile&amp;v=4">(BVL 2019)</a>. Globally, they affect an estimated 600 million people a year and impact socioeconomic development at different levels. These outbreaks are mainly due to <em>Salmonella spp.</em> followed by <em>Campylobacter spp.</em> and Noroviruses, as studied by the <a href="https://www.who.int/publications/i/item/9789241565165"><strong>Food safety - World Health Organization (WHO)</strong></a>.</p>

<p>During the investigation of a foodborne outbreak, a microbiological analysis of the potentially responsible food vehicle is performed in order to detect the responsible pathogens and identify the contamination source. By default, the <a href="https://eur-lex.europa.eu/LexUriServ/LexUriServ.do?uri=OJ:L:2005:338:0001:0026:EN:PDF"><strong>European Regulation (EC)</strong></a> follows ISO standards to detect bacterial pathogens in food: pathogens are detected and identified by <strong>stepwise cultures</strong> on selective media and/or <strong>targeting specific genes with real-time PCRs</strong>. The current gold standard is Pulsed-field Gel Electrophoresis (PFGE) or Multiple-Locus Variable Number Tandem Repeat Analysis (MLVA) to characterize the detected strains. These techniques have some disadvantages.</p>

<p><strong>Whole Genome Sequencing</strong> (WGS) has been proposed as an alte<span class="notranslate">rna</span>tive. With just one sequencing run, we can:</p>
<ul>
  <li>detect all genes</li>
  <li>run phylogenetic analysis to link cases</li>
  <li>get information on antimicrobial resistance genes, virulence, serotype, resistance to sanitizers, root cause, and other critical factors in one assay, including historical reference to pathogen emergence.</li>
</ul>

<p>WGS is more than a surveillance tool and was recommended by the European Centre for Disease Prevention and Control (ECDC) and the European Food Safety Authority (EFSA) for surveillance and outbreak investigation. WGS still requires isolation of the targeted pathogen, which is a time-consuming process, the execution is not always straightforward, nor the success is guaranteed. <strong>Sequencing methods without prior isolation could solve this issue</strong>.</p>

<p>The evolution of sequencing techniques in the last decades has made the development of shotgun metagenomic sequencing possible, <em>i.e.</em> the <strong>direct sequencing of all <span class="notranslate">DNA</span> present in a sample</strong>. This approach gives an overview of the genomic composition of all cells in the sample, including the food source itself, the microbial community, and any possible pathogens and their complete genetic information without the need for prior isolation. Several studies have demonstrated the potential of shotgun metagenomics to identify and characterize pathogens and their functional characteristics (<em>e.g.</em> virulence genes) in naturally contaminated or purposefully spiked food samples.</p>

<p>The currently available studies used Illumina sequencing, generating short <span class="notranslate">reads</span>. Longer read lengths, generated by third-generation sequencing platforms such as Pacific Biosciences (PacBio) and Oxford Nanopore Technologies (ONT), make it <strong>easier and more practical to identify strains with fewer <span class="notranslate">reads</span></strong>. MinION (from Oxford Nanopore) is a portable, real-time device for ONT sequencing. Several proof-of-principle studies have shown the <strong>utility of ONT long-read sequencing from metagenomic samples for pathogen identification</strong> (<span class="citation"><a href="#CIUFFREDA20211497">Ciuffreda <i>et al.</i> 2021</a></span>).</p>

<!--SNIPPET-->
<blockquote class="comment">   <div id="comment-nanopore-sequencing" class="box-title" aria-label="comment box: Nanopore sequencing"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden"></span> Comment: Nanopore sequencing</div>   <p>Nanopore sequencing has several properties that make it well-suited for our purposes</p>   <ol>   <li>Long-read sequencing technology offers <strong>simplified</strong> and less ambiguous genome <strong>assembly</strong></li>   <li>Long-read sequencing gives the ability to <strong>span repetitive genomic regions</strong></li>   <li>Long-read sequencing makes it possible to <strong>identify large structural variations</strong></li> </ol>   <p><img src="/training-material/topics/metagenomics/images/plasmid-metagenomics-nanopore/nanopore_sequencing.png" alt="How nanopore sequencing works" title="Using nanopore sequencing, a single molecule of DNA or RNA can be sequenced without the need for PCR amplification or chemical labeling of the sample. (Image from: &lt;a href=&quot;https://doi.org/10.7875/togopic.2020.01&quot;&gt;Nanopore sequencing: The advantages of long reads for genome assembly&lt;/a&gt;)" /> <br /><br /></p>   <p>When using Oxford Nanopore Technologies (ONT) sequencing, the change in electrical current is measured over the membrane of a flow cell. When nucleotides pass the pores in the flow cell the current change is translated (basecalled) to nucleotides by a basecaller. A schematic overview is given in the picture above.</p>   <p>When sequencing using a MinIT or MinION Mk1C, the basecalling software is present on the devices. With basecalling the electrical signals are translated to bases (A,T,G,C) with a quality score per base. The sequenced <span class="notranslate">DNA</span> strand will be basecalled and this will form one read. Multiple <span class="notranslate">reads</span> will be stored in a fastq file.</p> </blockquote>

<p>To identify and track foodborne pathogens using long-read metagenomic sequencing, different samples of potentially contaminated food (at different time points or different locations) are prepared, <span class="notranslate">DNA</span> is extracted and sequenced using MinION (ONT). The generated sequencing data then need to be processed using bioinformatics tools.</p>

<p>In this tutorial, we will be presenting a series of <span class="notranslate">Galaxy</span> workflows whose main goals are to:</p>
<ol>
  <li><strong>agnostically detect pathogens</strong> (What exactly is this pathogen and what virulence factors does it carry?) from data extracted directly (without prior cultivation) from a potentially contaminated sample (e.g. food like chicken, beef, etc.) and sequenced using Nanopore</li>
  <li><strong>compare different samples to trace</strong> the possible source of contamination</li>
</ol>

<p>To illustrate how to process such data, we will use datasets generated by <a href="https://www.biolytix.ch/">Biolytix</a> with the following approach:</p>

<p><img src="./images/Biolytix_Workflow_Sequencing.png" alt="From left to right: Biolytix logo. Chicken + milk. An arrow going to the right toward Chicken + milk and a syringe with &quot;Contamination with known pathogens&quot; written below. An arrow going to the right toward an Eppendorf tube with &quot;DNA extraction&quot; written below,  An arrow going to the right toward a qPCR machine, and another arrow over the qPCR toward a Nanopore sequencing. . " loading="lazy" /></p>

<p>Food samples, here chicken, are spiked with known pathogens, here:</p>
<ul>
  <li><em>Salmonella enterica subsp. enterica</em>  in the sample named <code class="language-plaintext highlighter-rouge">Barcode 10 Spike 2</code></li>
  <li><em>Salmonella enterica subsp. houtenae</em> in the sample named <code class="language-plaintext highlighter-rouge">Barcode 11 Spike 2b</code></li>
</ul>

<p><span class="notranslate">DNA</span> in the samples is extracted, analyzed with qPCR, and sequenced via Nanopore. We start the tutorial from raw data generated by Nanopore.</p>

<blockquote class="agenda">
  <div id="agenda" class="box-title" aria-label="agenda box: ">Agenda</div>

  <p>In this tutorial, we will deal with:</p>

<ol id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#prepare-galaxy-and-data" id="markdown-toc-prepare-galaxy-and-data">Prepare <span class="notranslate">Galaxy</span> and data</a></li>
  <li><a href="#pre-processing" id="markdown-toc-pre-processing">Pre-Processing</a>    <ol>
      <li><a href="#quality-control-and-preprocessing" id="markdown-toc-quality-control-and-preprocessing">Quality Control and preprocessing</a></li>
      <li><a href="#host-read-filtering" id="markdown-toc-host-read-filtering">Host read filtering</a></li>
    </ol>
  </li>
  <li><a href="#taxonomy-profiling" id="markdown-toc-taxonomy-profiling">Taxonomy Profiling</a></li>
  <li><a href="#gene-based-pathogenic-identification" id="markdown-toc-gene-based-pathogenic-identification">Gene based pathogenic identification</a>    <ol>
      <li><a href="#assembly" id="markdown-toc-assembly">Assembly</a></li>
      <li><a href="#multilocus-sequence-typing" id="markdown-toc-multilocus-sequence-typing">Multilocus Sequence Typing</a></li>
      <li><a href="#antimicrobial-resistance-genes" id="markdown-toc-antimicrobial-resistance-genes">Antimicrobial Resistance Genes</a></li>
      <li><a href="#virulence-factor-identification" id="markdown-toc-virulence-factor-identification">Virulence Factor identification</a></li>
    </ol>
  </li>
  <li><a href="#snp-based-pathogenic-identification" id="markdown-toc-snp-based-pathogenic-identification">SNP based pathogenic identification</a>    <ol>
      <li><a href="#variant-calling-or-snp-calling" id="markdown-toc-variant-calling-or-snp-calling">Variant Calling or SNP Calling</a></li>
      <li><a href="#consensus-genome-building" id="markdown-toc-consensus-genome-building">Consensus Genome Building</a></li>
    </ol>
  </li>
  <li><a href="#pathogen-tracking-among-all-samples" id="markdown-toc-pathogen-tracking-among-all-samples">Pathogen Tracking among all samples</a>    <ol>
      <li><a href="#heatmap" id="markdown-toc-heatmap">Heatmap</a></li>
      <li><a href="#phylogenetic-tree-building" id="markdown-toc-phylogenetic-tree-building">Phylogenetic Tree building</a></li>
    </ol>
  </li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
</ol>

</blockquote>

<h1 id="prepare-galaxy-and-data">Prepare <span class="notranslate">Galaxy</span> and data</h1>
<p>Any analysis should get its own <span class="notranslate">Galaxy</span> history. So let’s start by creating a new one:</p>

<blockquote class="notranslate hands_on">
  <div id="hands-on-data-upload" class="box-title" aria-label="hands-on box: Data upload"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Data upload</div>

  <ol>
    <li>
      <p>Create a new history for this analysis</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div id="tip-creating-a-new-history" class="box-title"><button type="button" aria-controls="tip-creating-a-new-history-contents" aria-expanded="true" aria-label="Toggle tip box: Creating a new history"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Creating a new history<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Click the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel.</p>   <p>If the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> is missing:</p>   <ol>   <li>Click on the <i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-gear</span> icon (<strong>History options</strong>) on the top of the history panel</li>   <li>Select the option <strong>Create New</strong> from the menu</li> </ol> </blockquote>
    </li>
    <li>
      <p>Rename the history</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div id="tip-renaming-a-history" class="box-title"><button type="button" aria-controls="tip-renaming-a-history-contents" aria-expanded="true" aria-label="Toggle tip box: Renaming a history"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Renaming a history<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>
    </li>
  </ol>

</blockquote>

<p>Before we can begin any <span class="notranslate">Galaxy</span> analysis, we need to upload the input data: FASTQ files with the sequenced samples.</p>

<blockquote class="notranslate hands_on">
  <div id="hands-on-import-datasets" class="box-title" aria-label="hands-on box: Import datasets"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Import datasets</div>

  <ol>
    <li>
      <p>Import the following samples via link from <a href="https://zenodo.org/record/7593928">Zenodo</a> or <span class="notranslate">Galaxy</span> shared data libraries:</p>

      <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/7593928/files/Barcode10_Spike2.fastq.gz
https://zenodo.org/record/7593928/files/Barcode11_Spike2b.fastq.gz
</code></pre></div>      </div>

      <!--SNIPPET-->
      <blockquote class="tip">   <div id="tip-importing-via-links" class="box-title"><button type="button" aria-controls="tip-importing-via-links-contents" aria-expanded="true" aria-label="Toggle tip box: Importing via links"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Importing via links<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Open the <span class="notranslate">Galaxy</span> Upload Manager (<i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-upload</span> on the top-right of the tool panel)</p>   </li>   <li>Select <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>
      <!--SNIPPET-->
      <blockquote class="tip">   <div id="tip-importing-data-from-a-data-library" class="box-title"><button type="button" aria-controls="tip-importing-data-from-a-data-library-contents" aria-expanded="true" aria-label="Toggle tip box: Importing data from a data library"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Importing data from a data library<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <p>As an alte<span class="notranslate">rna</span>tive to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ul>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor</li>   <li>Select the desired files</li>   <li>Click on the <strong>To History</strong> button near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>In the pop-up window, select the history you want to import the files to (or create a new one)</li>   <li>Click on <strong>Import</strong></li> </ul> </blockquote>
    </li>
    <li>
      <p>Add a tag to each dataset (one with <code class="language-plaintext highlighter-rouge">#Barcode10</code> and the other <code class="language-plaintext highlighter-rouge">#Barcode11</code>)</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div id="tip-adding-a-tag" class="box-title"><button type="button" aria-controls="tip-adding-a-tag-contents" aria-expanded="true" aria-label="Toggle tip box: Adding a tag"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Adding a tag<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on the dataset</li>   <li>Click on <i class="fas fa-tags" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-tags</span> <strong>Add Tags</strong></li>   <li>     <p>Add a tag starting with <code class="language-plaintext highlighter-rouge">#</code></p>     <p>Tags starting with <code class="language-plaintext highlighter-rouge">#</code> will be automatically propagated to the outputs of tools using this dataset.</p>   </li>   <li>Check that the tag is appearing below the dataset name</li> </ul> </blockquote>
    </li>
  </ol>

</blockquote>

<p>In this tutorial, we can offer 2 versions:</p>
<ul>
  <li>A short version, running prebuilt workflows</li>
  <li>A long version, going step-by-step</li>
</ul>

<blockquote class="notranslate hands_on gtn-cyoa" id="gtn-cyoa">
	<div class="box-title" aria-label="hands-on box: choose your own tutorial"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Choose Your Own Tutorial</div>
	<p>This is a "Choose Your Own Tutorial" section, where you can select between multiple paths. Click one of the buttons below to select how you want to follow the tutorial</p>
	
	
		<input id="cyoa-opt1" type="radio" name="cyoa" value="Short-Version" onclick="cyoaChoice('Short-Version')" />
		<label for="cyoa-opt1" class="select btn btn-secondary">Short Version</label>
	
	
		<input id="cyoa-opt2" type="radio" name="cyoa" value="Long-Version" onclick="cyoaChoice('Long-Version')" />
		<label for="cyoa-opt2" class="select btn btn-secondary">Long Version</label>
	
	
	

	
	<script type="text/javascript">
		function ready(fn) {
			if (document.readyState != 'loading'){
				fn();
			} else {
				document.addEventListener('DOMContentLoaded', fn);
			}
		}
		ready(function() {
			cyoaDefault("ShortVersion");
		})
	</script>
	
</blockquote>

<h1 id="pre-processing">Pre-Processing</h1>

<p>Before starting any analysis, it is always a good idea to assess the quality of your input data and to discard poor quality base content by trimming and filtering <span class="notranslate">reads</span>.</p>

<div class="Short-Version">

  <p>In this section we will run a <span class="notranslate">Galaxy</span> <span class="notranslate">workflow</span> that performs the following tasks with the following tools:</p>
  <ol>
    <li>Assess the <span class="notranslate">reads</span> quality before and after preprocessing it using <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><strong>FastQC</strong></a>, <a href="https://github.com/wdecoster/NanoPlot"><strong>NanoPlot</strong></a> and  <a href="https://multiqc.info/"><strong>MultiQC</strong></a> (<span class="citation"><a href="#Ewels2016">Ewels <i>et al.</i> 2016</a></span>)</li>
    <li>Trimming and filtering <span class="notranslate">reads</span> by length and quality using <a href="https://github.com/rrwick/Porechop"><strong>Porechop</strong></a> and <strong>Fastp</strong> (<span class="citation"><a href="#Chen2018">Chen <i>et al.</i> 2018</a></span>)</li>
    <li>Remove all possible hosts sequences e.g. chicken, cow, etc. using <a href="https://ccb.jhu.edu/software/kraken2/"><strong>Kraken2</strong></a> (<span class="citation"><a href="#Wood2014">Wood and Salzberg 2014</a></span>) with the <a href="https://github.com/lskatz/Kalamari"><strong>Kalamari</strong></a> database, and table manipulation tools, which are <strong>Filter Tabular</strong> (<span class="citation"><a href="#Johnson2018">Johnson <i>et al.</i> 2018</a></span>) and <strong>Filter Sequence By ID</strong> (<span class="citation"><a href="#Cock2013">Cock <i>et al.</i> 2013</a></span>) to separate the sequences into host and non-host sequences before moving on, in the next section, with the non-host sequences.</li>
  </ol>

  <p>We will run all these steps using a single <span class="notranslate">workflow</span>, then discuss each step and the results in more detail.</p>

  <blockquote class="notranslate hands_on">
    <div id="hands-on-pre-processing" class="box-title" aria-label="hands-on box: Pre-Processing"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Pre-Processing</div>

    <ol>
      <li><strong>Import the <span class="notranslate">workflow</span></strong> into <span class="notranslate">Galaxy</span>
        <ul>
          <li>Copy the URL (e.g. via right-click) of <a href="/training-material/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/nanopore_preprocessing.ga">this <span class="notranslate">workflow</span></a> or download it to your computer.</li>
          <li>Import the <span class="notranslate">workflow</span> into <span class="notranslate">Galaxy</span></li>
        </ul>

        <!--SNIPPET-->
        <blockquote class="tip">   <div id="tip-importing-a-workflow" class="box-title"><button type="button" aria-controls="tip-importing-a-workflow-contents" aria-expanded="true" aria-label="Toggle tip box: Importing a workflow"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Importing a <span class="notranslate">workflow</span><span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <em><span class="notranslate">Workflow</span></em> on the top menu bar of <span class="notranslate">Galaxy</span>. You will see a list of all your workflows.</li>   <li>Click on the upload icon <i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-upload</span> at the top-right of the screen</li>   <li>Provide your <span class="notranslate">workflow</span>     <ul>       <li>Option 1: Paste the URL of the <span class="notranslate">workflow</span> into the box labelled <em>“Archived <span class="notranslate">Workflow</span> URL”</em></li>       <li>Option 2: Upload the <span class="notranslate">workflow</span> file in the box labelled <em>“Archived <span class="notranslate">Workflow</span> File”</em></li>     </ul>   </li>   <li>Click the <strong>Import <span class="notranslate">workflow</span></strong> button</li> </ul> </blockquote>
      </li>
      <li>
        <p>Run <strong><span class="notranslate">Workflow</span> 1:  Nanopore Datasets - Pre-Processing</strong> <i class="fas fa-share-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">workflow</span></span> using the following parameters</p>

        <!--SNIPPET-->
        <blockquote class="tip">   <div id="tip-running-a-workflow" class="box-title"><button type="button" aria-controls="tip-running-a-workflow-contents" aria-expanded="true" aria-label="Toggle tip box: Running a workflow"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Running a <span class="notranslate">workflow</span><span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <em><span class="notranslate">Workflow</span></em> on the top menu bar of <span class="notranslate">Galaxy</span>. You will see a list of all your workflows.</li>   <li>Click on the <i class="fas fa-play" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">workflow</span>-run</span> (<em>Run <span class="notranslate">workflow</span></em>) button next to your <span class="notranslate">workflow</span></li>   <li>Configure the <span class="notranslate">workflow</span> as needed</li>   <li>Click the <strong>Run <span class="notranslate">Workflow</span></strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>

        <ul>
          <li>
            <p><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“1: Nanopore <span class="notranslate">reads</span> of a sample”</em>: FastQ files</p>

            <!--SNIPPET-->
            <blockquote class="tip">   <div id="tip-select-multiple-datasets" class="box-title"><button type="button" aria-controls="tip-select-multiple-datasets-contents" aria-expanded="true" aria-label="Toggle tip box: Select multiple datasets"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Select multiple datasets<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on <i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <strong>Multiple datasets</strong></li>   <li>Select several files by keeping the <kbd>Ctrl</kbd> (or <kbd>COMMAND</kbd>) key pressed and clicking on the files of interest</li> </ol> </blockquote>
          </li>
          <li>
            <p><em>“2: Host to Remove Specifier”</em>: <code class="language-plaintext highlighter-rouge">^.*Gallus|Homo|Bos.*$</code></p>

            <p>We specify here the taxonomic names of the hosts so we can filter <span class="notranslate">reads</span> assigned to these hosts. To be generic, we remove here:</p>
            <ul>
              <li>Human (<code class="language-plaintext highlighter-rouge">Homo</code>)</li>
              <li>Chicken (<code class="language-plaintext highlighter-rouge">Gallus</code>)</li>
              <li>Beef (<code class="language-plaintext highlighter-rouge">Bos</code>)</li>
            </ul>

            <p>If the contaminated food would be known to come from a different source and may, thus, include other host genomes, you could change the value here.</p>
          </li>
        </ul>
      </li>
    </ol>

  </blockquote>

  <p>The <span class="notranslate">workflow</span> will take a little while to complete. Once tools have completed, the results will be available in your history for viewing. Note that only the most important outputs will be visible; intermediate files are hidden by default.</p>

  <p>While you are waiting for the <span class="notranslate">workflow</span> to complete, please continue reading in the next section(s) where we will go into a bit more detail about what happens at each step of the <span class="notranslate">workflow</span> we launched and examine the results.</p>
</div>

<h2 id="quality-control-and-preprocessing">Quality Control and preprocessing</h2>

<p>During sequencing, errors are introduced, such as incorrect nucleotides being called. These are due to the technical limitations of each sequencing platform. Sequencing errors might bias the analysis and can lead to a misinterpretation of the data. <strong>Sequence quality control is therefore an essential first step in your analysis.</strong></p>

<p>In this tutorial we use similar tools as described in the tutorial <a href="/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html">“Quality control”</a>, but more specific to Nanopore data:</p>

<ul>
  <li>Quality control with
    <ul>
      <li><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"><strong>FastQC</strong></a> generates a web report that will aid you in assessing the quality of your data</li>
      <li><a href="https://github.com/wdecoster/NanoPlot"><strong>NanoPlot</strong></a> plotting tool for long read sequencing data and alignments</li>
    </ul>

    <div class="Long-Version">

      <blockquote class="notranslate hands_on">
        <div id="hands-on-initial-quality-assessment" class="box-title" aria-label="hands-on box:  Initial quality assessment "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Initial quality assessment</div>
        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0"><strong>FastQC</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+<span class="notranslate">galaxy</span>0</span></span>  with the following parameters:
            <ul>
              <li>
                <p><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Raw read data from your current history”</em>: both FastQ file</p>

                <!--SNIPPET-->
                <blockquote class="tip">   <div id="tip-select-multiple-datasets-1" class="box-title"><button type="button" aria-controls="tip-select-multiple-datasets-1-contents" aria-expanded="true" aria-label="Toggle tip box: Select multiple datasets"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Select multiple datasets<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on <i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <strong>Multiple datasets</strong></li>   <li>Select several files by keeping the <kbd>Ctrl</kbd> (or <kbd>COMMAND</kbd>) key pressed and clicking on the files of interest</li> </ol> </blockquote>
              </li>
            </ul>
          </li>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.28.2+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.28.2+galaxy1"><strong>NanoPlot</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.28.2+<span class="notranslate">galaxy</span>1</span></span>  with the following parameters:
            <ul>
              <li><em>“Select multifile mode”</em>: <code class="language-plaintext highlighter-rouge">batch</code>
                <ul>
                  <li><em>“Type of the file(s) to work on”</em>: <code class="language-plaintext highlighter-rouge">fastq</code>
                    <ul>
                      <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Data input files”</em>: both FastQ file</li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>

            <blockquote class="comment">
              <div id="comment" class="box-title" aria-label="comment box: "><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden"></span> Comment</div>
              <p>This step, as it does not require the results of FastQC to run, can be launched even if FastQC is not ready</p>
            </blockquote>
          </li>
        </ol>

      </blockquote>

    </div>
  </li>
  <li>
    <p>Read trimming and filtering with <a href="https://github.com/rrwick/Porechop"><strong>Porechop</strong></a> and <strong>Fastp</strong> (<span class="citation"><a href="#Chen2018">Chen <i>et al.</i> 2018</a></span>)</p>

    <div class="Long-Version">

      <blockquote class="notranslate hands_on">
        <div id="hands-on-read-trimming-and-filtering" class="box-title" aria-label="hands-on box:  Read trimming and filtering "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Read trimming and filtering</div>

        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/porechop/porechop/0.2.4" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/porechop/porechop/0.2.4"><strong>Porechop</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/porechop/porechop/0.2.4</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Input FASTA/FASTQ”</em>: both FastQ file</li>
              <li><em>“Output format for the <span class="notranslate">reads</span>”</em>: <code class="language-plaintext highlighter-rouge">fastq.gz</code></li>
            </ul>
          </li>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0"><strong>fastp</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+<span class="notranslate">galaxy</span>0</span></span>  with the following parameters:
            <ul>
              <li><em>“Single-end or paired <span class="notranslate">reads</span>”</em>: <code class="language-plaintext highlighter-rouge">Single-end</code>
                <ul>
                  <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Input 1”</em>: outputs of <strong>Porechop</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
                </ul>
              </li>
              <li>In <em>Output Options</em>
                <ul>
                  <li><em>“Output JSON report”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                </ul>
              </li>
            </ul>

            <blockquote class="comment">
              <div id="comment-1" class="box-title" aria-label="comment box: "><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden"></span> Comment</div>
              <p>This step can be launched even if <strong>Porechop</strong> is not done. It will be scheduled and wait until <strong>Porechop</strong> is done to start.</p>
            </blockquote>
          </li>
        </ol>
      </blockquote>

    </div>
  </li>
  <li>
    <p>Quality recheck after read trimming and filtering with <strong>FastQC</strong> and <strong>Nanoplot</strong> and report aggregation with <a href="https://multiqc.info/"><strong>MultiQC</strong></a></p>

    <div class="Long-Version">

      <blockquote class="notranslate hands_on">
        <div id="hands-on-final-quality-checks" class="box-title" aria-label="hands-on box:  Final quality checks "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Final quality checks</div>
        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+galaxy0"><strong>FastQC</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.73+<span class="notranslate">galaxy</span>0</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Raw read data from your current history”</em>: outputs of <strong>fastp</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
            </ul>
          </li>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.28.2+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.28.2+galaxy1"><strong>NanoPlot</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/1.28.2+<span class="notranslate">galaxy</span>1</span></span>  with the following parameters:
            <ul>
              <li><em>“Select multifile mode”</em>: <code class="language-plaintext highlighter-rouge">batch</code>
                <ul>
                  <li><em>“Type of the file(s) to work on”</em>: <code class="language-plaintext highlighter-rouge">fastq</code>
                    <ul>
                      <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“files”</em>: outputs of <strong>fastp</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+galaxy0"><strong>MultiQC</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.11+<span class="notranslate">galaxy</span>0</span></span>  with the following parameters:
            <ul>
              <li>In <em>“Results”</em>:
                <ul>
                  <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert Results”</em>
                    <ul>
                      <li><em>“Which tool was used generate logs?”</em>: <code class="language-plaintext highlighter-rouge">FastQC</code>
                        <ul>
                          <li>In <em>“FastQC output”</em>:
                            <ul>
                              <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert FastQC output”</em>
                                <ul>
                                  <li><em>“Type of FastQC output?”</em>: <code class="language-plaintext highlighter-rouge">Raw data</code></li>
                                  <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“FastQC output”</em>: 4 <code class="language-plaintext highlighter-rouge">Raw data</code> outputs of <strong>FastQC</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
                                </ul>
                              </li>
                            </ul>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                  <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert Results”</em>
                    <ul>
                      <li><em>“Which tool was used generate logs?”</em>: <code class="language-plaintext highlighter-rouge">fastp</code>
                        <ul>
                          <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Output of fastp”</em>: <code class="language-plaintext highlighter-rouge">JSON report</code> outputs of <strong>fastp</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ol>
      </blockquote>

    </div>
  </li>
</ul>

<blockquote class="question">
  <div id="question" class="box-title" aria-label="question box: "><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Question</div>

  <p>Inspect the HTML output of <strong>MultiQC</strong> for <code class="language-plaintext highlighter-rouge">Barcode10</code></p>

  <ol>
    <li>How many sequences does <code class="language-plaintext highlighter-rouge">Barcode10</code> contain before and after trimming?</li>
    <li>What is the quality score over the <span class="notranslate">reads</span> before and after trimming? And the mean score?</li>
    <li>What is the importance of <strong>FastQC</strong>?</li>
  </ol>

  <blockquote class="solution">
    <div id="solution" class="box-title"><button type="button" aria-controls="solution-contents" aria-expanded="true" aria-label="Toggle solution box: "><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"></span> Solution<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>Before trimming the file has 114,986 sequences and After trimming the file has 91,434 sequences</li>
      <li>
        <p>The “Per base sequence quality” is globally medium: the quality score stays above 20 over the entire length of <span class="notranslate">reads</span> after trimming, while quality below 20 could be seen before trimming specially at the beginning and the end of the <span class="notranslate">reads</span>.</p>

        <p><img src="./images/fastqc_per_base_sequence_quality_plot_barcode10.png" alt="Sequence Quality. " loading="lazy" /></p>
      </li>
      <li>After checking what is wrong, e.g. before trimming, we should think about the errors reported by <strong>FastQC</strong>: they may come from the type of sequencing or what we sequenced (check the <a href="/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html">“Quality control” training</a>: <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FastQC</a> for more details). However, despite these challenges, we can already see sequences getting slightly better after the trimming and filtering, so now we can proceed with our analyses.</li>
    </ol>
  </blockquote>
</blockquote>

<blockquote class="comment">
  <div id="comment-2" class="box-title" aria-label="comment box: "><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden"></span> Comment</div>
  <p>For more information about how to interpret the plots generated by <strong>FastQC</strong> and <strong>MultiQC</strong>, please see our dedicated <a href="/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html">“Quality control”</a> Tutorial.</p>
</blockquote>

<h2 id="host-read-filtering">Host read filtering</h2>

<p>Generally, we are not interested in the food (host) sequences, rather only those originating from the pathogen itself. It is an important to get rid of all host sequences and to only retain sequences that might include a pathogen, both in order to speed up further steps and to avoid host sequences compromising the analysis.</p>

<p>In this tutorial, we know the samples come from <strong>chicken</strong> meat spiked with <strong><em>Salmonella</em></strong> so we already know what will we get as the host and the main pathogen.</p>

<p>In this tutorial we use:</p>
<ol>
  <li>
    <p>Assign <span class="notranslate">reads</span> to taxa using <strong>Kraken2</strong> (<span class="citation"><a href="#Wood2014">Wood and Salzberg 2014</a></span>) and <strong>Kalamari</strong>, a database of completed assemblies for metagenomics-related tasks used widely in contamination and host filtering</p>

    <div class="Long-Version">

      <blockquote class="notranslate hands_on">
        <div id="hands-on-read-taxonomic-classification-for-host-filtering" class="box-title" aria-label="hands-on box: Read taxonomic classification for host filtering "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Read taxonomic classification for host filtering</div>

        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1"><strong>Kraken2</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+<span class="notranslate">galaxy</span>1</span></span>  with the following parameters:
            <ul>
              <li><em>“Single or paired <span class="notranslate">reads</span>”</em>: <code class="language-plaintext highlighter-rouge">Single</code>
                <ul>
                  <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Input sequences”</em>: outputs of <strong>fastp</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
                </ul>
              </li>
              <li><em>“Print scientific names instead of just taxids”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
              <li>In <em>“Create Report”</em>:
                <ul>
                  <li><em>“Print a report with aggregrate counts/clade to file”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                  <li><em>“Format report output like Kraken 1’s kraken-mpa-report”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                  <li><em>“Report counts for ALL taxa, even if counts are zero”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                  <li><em>“Report minimizer data”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                </ul>
              </li>
              <li><em>“Select a Kraken2 database”</em>: <code class="language-plaintext highlighter-rouge">kalamari</code></li>
            </ul>
          </li>
        </ol>

      </blockquote>

    </div>

    <blockquote class="question">
      <div id="question-1" class="box-title" aria-label="question box: "><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Question</div>

      <p>Inspect the report of <strong>Kraken2</strong> for <code class="language-plaintext highlighter-rouge">Barcode10</code></p>

      <ol>
        <li>What is the species of the host?</li>
        <li>How many sequences of this host was found?</li>
      </ol>

      <blockquote class="solution">
        <div id="solution-1" class="box-title"><button type="button" aria-controls="solution-1-contents" aria-expanded="true" aria-label="Toggle solution box: "><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"></span> Solution<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

        <ol>
          <li><em>Gallus gallus</em> (taxid 9031), which is chicken</li>
          <li>836</li>
        </ol>

      </blockquote>
    </blockquote>
  </li>
  <li>
    <p>Filter host assigned <span class="notranslate">reads</span> based on <strong>Kraken2</strong> assignments</p>
    <ol>
      <li>Manipulate <strong>Kraken2</strong> classification to extract the sequence ids of all hosts sequences identified with <strong>Kraken2</strong></li>
      <li>Filter the FASTQ files to get 1 ouput with the host-assigned sequences and 1 output without the host-assigned <span class="notranslate">reads</span></li>
    </ol>

    <div class="Long-Version">

      <blockquote class="notranslate hands_on">
        <div id="hands-on-host-read-filtering" class="box-title" aria-label="hands-on box:  Host read filtering "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Host read filtering</div>

        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/filter_tabular/filter_tabular/2.0.0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/filter_tabular/filter_tabular/2.0.0"><strong>Filter Tabular</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/filter_tabular/filter_tabular/2.0.0</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Tabular Dataset to filter”</em>: <code class="language-plaintext highlighter-rouge">Classification</code> outputs of <strong>Kraken2</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li>In <em>“Filter Tabular Input Lines”</em>:
                <ul>
                  <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert Filter Tabular Input Lines”</em>
                    <ul>
                      <li><em>“Filter By”</em>: <code class="language-plaintext highlighter-rouge">by regex <span class="notranslate">expression</span> matching</code>
                        <ul>
                          <li>
                            <p><em>“regex pattern”</em>: <code class="language-plaintext highlighter-rouge">^.*Gallus|Homo|Bos.*$</code></p>

                            <p>We specify here the taxonomic names of the hosts so we can filter <span class="notranslate">reads</span> assigned to these hosts. To be generic, we remove here:</p>
                            <ul>
                              <li>Human (<code class="language-plaintext highlighter-rouge">Homo</code>)</li>
                              <li>Chicken (<code class="language-plaintext highlighter-rouge">Gallus</code>)</li>
                              <li>Beef (<code class="language-plaintext highlighter-rouge">Bos</code>)</li>
                            </ul>

                            <p>If the contaminated food comes from and may include other animals, you can change the value here.</p>
                          </li>
                          <li>
                            <p><em>“action for regex match”</em>: <code class="language-plaintext highlighter-rouge">include line if pattern found</code></p>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/peterjc/seq_filter_by_id/seq_filter_by_id/0.2.7" title="Tested with toolshed.g2.bx.psu.edu/repos/peterjc/seq_filter_by_id/seq_filter_by_id/0.2.7"><strong>Filter sequences by ID</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/peterjc/seq_filter_by_id/seq_filter_by_id/0.2.7</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Sequence file to be filtered”</em>: outputs of <strong>fastp</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li><em>“Filter using the ID list from”</em>: <code class="language-plaintext highlighter-rouge">tabular file</code>
                <ul>
                  <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Tabular file containing sequence identifiers”</em>: outputs of <strong>Filter Tabular</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
                  <li><em>“Column(s) containing sequence identifiers”</em>: <code class="language-plaintext highlighter-rouge">Column: 2</code></li>
                </ul>
              </li>
              <li><em>“Output positive matches, negative matches, or both?”</em>: <code class="language-plaintext highlighter-rouge">Both positive matches (ID on list) and negative matches (ID not on list), as two files</code></li>
            </ul>
          </li>
        </ol>

      </blockquote>

    </div>
  </li>
</ol>

<blockquote class="comment">
  <div id="comment-3" class="box-title" aria-label="comment box: "><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden"></span> Comment</div>

  <p>We will need the outputs from this section in the next one.  If yours is still running or you get an error you can go on and upload it so you can start the next <span class="notranslate">workflow</span>, the next hands-on is optional.</p>

  <blockquote class="notranslate hands_on">
    <div id="hands-on-optional-data-upload" class="box-title" aria-label="hands-on box: Optional Data upload"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Optional Data upload</div>

    <ol>
      <li>
        <p>Import the quality processed samples fastqsanger files via link from <a href="https://zenodo.org/record/7593928">Zenodo</a> or the Shared Data library:</p>

        <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/7593928/files/Nanopore_processed_sequenced_<span class="notranslate">reads</span>_Barcode10_Spike2.fastqsanger
https://zenodo.org/record/7593928/files/Nanopore_processed_sequenced_<span class="notranslate">reads</span>_Barcode11_Spike2b.fastqsanger
</code></pre></div>        </div>
      </li>
      <li>
        <p>Add tags to the datasets</p>
      </li>
    </ol>

  </blockquote>
</blockquote>

<h1 id="taxonomy-profiling">Taxonomy Profiling</h1>

<p>In this section we would like to identify the different organisms found in our samples by assigning taxonomy levels to the <span class="notranslate">reads</span> starting from the kingdom level down to the species level and visualize the result. It’s important to check what might be the species of a possible pathogen to be found, it gets us closer to the investigation as well as discovering possible multiple food infections if any existed.</p>

<!--SNIPPET-->
<blockquote class="details">   <div id="details-what-is-taxonomy" class="box-title"><button type="button" aria-controls="details-what-is-taxonomy-contents" aria-expanded="true" aria-label="Toggle details box: What is Taxonomy?"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Details: What is Taxonomy?<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Taxonomy is the method used to naming, defining (circumscribing) and classifying groups of biological organisms based on shared characteristics such as morphological characteristics, phylogenetic characteristics, <span class="notranslate">DNA</span> data, etc. It is founded on the concept that the similarities descend from a common evolutionary ancestor.</p>   <p>Defined groups of organisms are known as <strong>taxa</strong>. Taxa are given a taxonomic rank and are aggregated into super groups of higher rank to create a taxonomic hierarchy. The taxonomic hierarchy includes eight levels: <strong>Domain, Kingdom, Phylum, Class, Order, Family, Genus and Species.</strong></p>   <p><img src="/training-material/topics/metagenomics/faqs/images/taxonomy.png" alt="Example of taxonomy. It starts, top to bottom, with Kingdom &quot;Animalia&quot;, Phylum &quot;Chordata&quot;, Class &quot;Mammalia&quot;, and Order &quot;Carnivora&quot;. Then it splits in 3. On the left, Family &quot;Felidae&quot;, with 2 genus &quot;Felis&quot; and &quot;Panthera&quot; and below 3 species &quot;F. catus&quot; and &quot;F. pardalis&quot; below &quot;Felis&quot;, &quot;P. pardus&quot; below &quot;Panthera&quot;. In the middle, Family &quot;Canidae&quot;, genus &quot;Canis&quot; and 2 species &quot;C. familiaris&quot; and &quot;C. lupus&quot;. On the right, Family &quot;Ursidae&quot;, Genus &quot;Ursus&quot; and 2 species &quot;U. arctos&quot; and &quot;U. horribilus&quot;. Below each species is a illustration of the species" /></p>   <p>The classification system begins with <strong>3 domains</strong> that encompass all living and extinct forms of life</p>   <ul>   <li>The <strong>Bacteria</strong> and <strong>Archae</strong> are mostly microscopic, but quite widespread.</li>   <li>Domain <strong>Eukarya</strong> contains more complex organisms</li> </ul>   <p>When new species are found, they are assigned into taxa in the taxonomic hierarchy. For example for the cat:</p>   <table>   <thead>     <tr>       <th>Level</th>       <th>Classification</th>     </tr>   </thead>   <tbody>     <tr>       <td>Domain</td>       <td>Eukaryota</td>     </tr>     <tr>       <td>Kingdom</td>       <td>Animalia</td>     </tr>     <tr>       <td>Phylum</td>       <td>Chordata</td>     </tr>     <tr>       <td>Class</td>       <td>Mammalia</td>     </tr>     <tr>       <td>Order</td>       <td>Carnivora</td>     </tr>     <tr>       <td>Family</td>       <td>Felidae</td>     </tr>     <tr>       <td>Genus</td>       <td><em>Felis</em></td>     </tr>     <tr>       <td>Species</td>       <td><em>F. catus</em></td>     </tr>   </tbody> </table>   <p>Let’s explore taxonomy in the Tree of Life, using <a href="https://lifemap.univ-lyon1.fr/">Lifemap</a></p>   <iframe id="Lifemap" src="https://lifemap.univ-lyon1.fr/explore.html" frameborder="0" width="100%" height="600px"></iframe> </blockquote>

<p>In the previous section we ran <strong>Kraken2</strong> along with the <strong>Kalamari</strong> database, which is also a kind of taxonomy profiling but the database used is designed to include all possible host sequences. In the following part, we run <strong>Kraken2</strong> again; but this time with one of its built-in databases, <strong>Standard PlusPF</strong>, which can give us more insight into pathogen candidate species than <strong>Kalamari</strong>. You can test this yourself by comparing reports of both <strong>Kraken2</strong> runs.</p>

<blockquote class="details">
  <div id="details-kraken2-and-the-k-mer-approach-for-taxonomy-classification" class="box-title"><button type="button" aria-controls="details-kraken2-and-the-k-mer-approach-for-taxonomy-classification-contents" aria-expanded="true" aria-label="Toggle details box: Kraken2 and the k-mer approach for taxonomy classification"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Details: Kraken2 and the k-mer approach for taxonomy classification<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

  <p>In the \(k\)-mer approach for taxonomy classification, we use a database containing <span class="notranslate">DNA</span> sequences of genomes whose taxonomy we already know. On a computer, the genome sequences are broken into short pieces of length \(k\) (called \(k\)-mers), usually 30bp.</p>

  <p><strong>Kraken</strong> examines the \(k\)-mers within the query sequence, searches for them in the database, looks for where these are placed within the taxonomy tree inside the database, makes the classification with the most probable position, then maps \(k\)-mers to the lowest common ancestor (LCA) of all genomes known to contain the given \(k\)-mer.</p>

  <figure id="figure-1"><img src="../../images/metagenomics-nanopore/kmers-kraken.jpg" alt="Kraken2. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figure 1:</span> Kraken sequence classification algorithm. To classify a sequence, each k-mer in the sequence is mapped to the lowest common ancestor (LCA, i.e. the lowest node) of the genomes that contain that k-mer in the database. The taxa associated with the sequence's k-mers, as well as the taxa's ancestors, form a pruned subtree of the general taxonomy tree, which is used for classification. In the classification tree, each node has a weight equal to the number of k-mers in the sequence associated with the node's taxon. Each root-to-leaf (RTL) path in the classification tree is scored by adding all weights in the path, and the maximal RTL path in the classification tree is the classification path (nodes highlighted in yellow). The leaf of this classification path (the orange, leftmost leaf in the classification tree) is the classification used for the query sequence. Source: <span class="citation"><a href="#Wood2014">Wood and Salzberg 2014</a></span></figcaption></figure>

</blockquote>

<div class="Short-Version">

  <blockquote class="notranslate hands_on">
    <div id="hands-on-taxonomy-profiling-and-visualisation" class="box-title" aria-label="hands-on box: Taxonomy Profiling and visualisation"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Taxonomy Profiling and visualisation</div>

    <ol>
      <li><strong>Import the <span class="notranslate">workflow</span></strong> into <span class="notranslate">Galaxy</span>
        <ul>
          <li>Copy the URL (e.g. via right-click) of <a href="/training-material/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/nanopore_taxonomy_profiling_and_visualization.ga">this <span class="notranslate">workflow</span></a> or download it to your computer.</li>
          <li>Import the <span class="notranslate">workflow</span> into <span class="notranslate">Galaxy</span></li>
        </ul>
      </li>
      <li>Run <strong><span class="notranslate">Workflow</span> 2: Nanopore Datasets - Taxonomy Profiling and Visualization</strong> <i class="fas fa-share-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">workflow</span></span> using the following parameters:
        <ul>
          <li><em>“Send results to a new history”</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
          <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Nanopore preprocessed <span class="notranslate">reads</span>”</em>: <code class="language-plaintext highlighter-rouge">Nanopore processed sequenced <span class="notranslate">reads</span></code> files for both tags</li>
          <li><em>“Sample Metadata”</em>: Leave empty</li>
        </ul>

        <!--SNIPPET-->
        <blockquote class="tip">   <div id="tip-running-a-workflow-1" class="box-title"><button type="button" aria-controls="tip-running-a-workflow-1-contents" aria-expanded="true" aria-label="Toggle tip box: Running a workflow"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Running a <span class="notranslate">workflow</span><span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <em><span class="notranslate">Workflow</span></em> on the top menu bar of <span class="notranslate">Galaxy</span>. You will see a list of all your workflows.</li>   <li>Click on the <i class="fas fa-play" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">workflow</span>-run</span> (<em>Run <span class="notranslate">workflow</span></em>) button next to your <span class="notranslate">workflow</span></li>   <li>Configure the <span class="notranslate">workflow</span> as needed</li>   <li>Click the <strong>Run <span class="notranslate">Workflow</span></strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>
      </li>
    </ol>

  </blockquote>

</div>

<p>To assign <span class="notranslate">reads</span> to taxons, we use <strong>Kraken2</strong> with <strong>Standard PlusPF</strong> database.</p>

<div class="Long-Version">

  <blockquote class="notranslate hands_on">
    <div id="hands-on-taxonomy-profiling" class="box-title" aria-label="hands-on box:  Taxonomy Profiling "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Taxonomy Profiling</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1"><strong>Kraken2</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+<span class="notranslate">galaxy</span>1</span></span>  with the following parameters:
        <ul>
          <li><em>“Single or paired <span class="notranslate">reads</span>”</em>: <code class="language-plaintext highlighter-rouge">Single</code>
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Input sequences”</em>: Outputs without matched ID of <strong>Filter sequences by ID</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
            </ul>
          </li>
          <li>In <em>“Create Report”</em>:
            <ul>
              <li><em>“Print a report with aggregrate counts/clade to file”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
            </ul>
          </li>
          <li><em>“Select a Kraken2 database”</em>: <code class="language-plaintext highlighter-rouge">Prebuilt Refseq indexes:  PlusPF (Standard plus protozoa and fungi) (Version:  2022-06-07 - Downloaded: 2022-09-04T165121Z)</code></li>
        </ul>
      </li>
    </ol>
  </blockquote>

</div>

<blockquote class="question">
  <div id="question-2" class="box-title" aria-label="question box: "><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Question</div>

  <p>Inspect the <strong>Kraken2</strong> report for <code class="language-plaintext highlighter-rouge">Barcode10</code> tag</p>

  <ol>
    <li>What is the most commonly found species?</li>
    <li>What is the second most commonly found species?</li>
    <li>How many sequences are classified and how many are unclassified?</li>
    <li>What are the differences between <strong>Kraken2</strong> tool’s report with <strong>Kalamari</strong> database and <strong>Kraken2</strong> tool’s report with <strong>Standard PlusPF</strong> database regarding the previous 3 questions?</li>
  </ol>

  <blockquote class="solution">
    <div id="solution-2" class="box-title"><button type="button" aria-controls="solution-2-contents" aria-expanded="true" aria-label="Toggle solution box: "><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"></span> Solution<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li><em>Escherichia coli</em> with 10,243 sequences</li>
      <li><em>Salmonella enterica</em> with 7,458 sequences</li>
      <li>40,143 sequences are classified and 50,455 are unclassified</li>
      <li>With <strong>Kalamari</strong> database the most found species is <em>Escherichia coli</em> with 12,577 sequences and the second most found species is <em>Salmonella enterica</em> with 10,632 sequences. The number of classified sequences are 32,020 sequences and the unclassified sequences are 59,414. In conclusion, both databases are able to show the same results of the most common species. However, the number of the classified sequences with <strong>Standard PlusPF</strong> database is higher than <strong>Kalamari</strong> database and it would be even higher since all chicken sequences were removed before testing the <strong>Standard PlusPF</strong> database.</li>
    </ol>
  </blockquote>
</blockquote>

<p>In order to view the taxonomy profiling produced by <strong>Kraken2</strong> tool, there are a lot of tools to be used afterwards such as <strong>Krona pie chart</strong>, however too many species were detected to be shown by this tool. For that reason, we have chosen the <strong>Phinch visualization</strong> interactive tool as it contains multiple visualization plots, it is interactive alowing you to choose between different parameters, you can visualize each taxonomic level on its own, you can have the metadata of the samples represented along with the taxonomic visualization, download all plots for publications and a lot of other benefits. For later, you can check out <a href="https://academic.oup.com/bioinformatics/article/36/4/1303/5573755"><strong>Pavian</strong></a> tool as well it can replace <strong>Phinch visualization</strong> with similar outputs.</p>

<p><strong>Phinch visualization</strong> needs a <strong>BIOM</strong> file format as an input, and for that we need the <a href="https://github.com/smdabdoub/kraken-biom"><strong>Kraken-Biom</strong></a>  tool to convert the <strong>Kraken2</strong> tabular output into a Biom file.</p>

<div class="Long-Version">

  <blockquote class="notranslate hands_on">
    <div id="hands-on-biom-generation" class="box-title" aria-label="hands-on box:  BIOM generation "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  BIOM generation</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/kraken_biom/kraken_biom/1.2.0+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/kraken_biom/kraken_biom/1.2.0+galaxy1"><strong>Kraken-biom</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/kraken_biom/kraken_biom/1.2.0+<span class="notranslate">galaxy</span>1</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Input files to Kraken-biom: Kraken report output file(s)”</em>: Report outputs of <strong>Kraken2</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Sample metadata file”</em>: Leave empty</li>
          <li><em>“Do you want to create an OTU IDs file”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
          <li><em>“Output Format”</em>: <code class="language-plaintext highlighter-rouge">JSON</code></li>
        </ul>
      </li>
    </ol>

  </blockquote>

</div>

<p>Once the BIOM file has been generated, we launch the interactive visualisation tool called <a href="https://www.phinch.org/"><strong>Phinch visualization</strong></a>:</p>

<div class="Long-Version">

  <blockquote class="notranslate hands_on">
    <div id="hands-on-visualisation-with-phinch" class="box-title" aria-label="hands-on box:  Visualisation with Phinch "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Visualisation with Phinch</div>

    <ol>
      <li><span class="tool" data-tool="interactive_tool_phinch" title="Tested with interactive_tool_phinch"><strong>Phinch Visualisation</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: interactive_tool_phinch</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Biom1 dataset”</em>: output of <strong>Kraken-biom</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        </ul>
      </li>
    </ol>

  </blockquote>

</div>

<p>Now let’s now explore the <strong>Phinch visulization</strong> tool running for <code class="language-plaintext highlighter-rouge">Barcode11</code> tag</p>

<blockquote class="notranslate hands_on">
  <div id="hands-on-explore-data-interactively" class="box-title" aria-label="hands-on box: Explore data interactively"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Explore data interactively</div>

  <ol>
    <li>
      <p>Open Phinch interactive tool</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div id="tip-open-interactive-tool" class="box-title"><button type="button" aria-controls="tip-open-interactive-tool-contents" aria-expanded="true" aria-label="Toggle tip box: Open interactive tool"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Open interactive tool<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Go to User &gt; Active InteractiveTools</li>   <li>Wait for the Phinch visualization to be running (Job Info)</li>   <li>Click on Phinch visualization</li> </ol> </blockquote>
    </li>
    <li>
      <p>Click on <strong>Proceed to Gallery</strong> button on the top right of the opened webpage to see all the plots</p>
    </li>
  </ol>

</blockquote>

<blockquote class="question">
  <div id="question-3" class="box-title" aria-label="question box: "><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Question</div>

  <ol>
    <li>What is the most commonly found species?</li>
    <li>What is the second most commonly found species?</li>
    <li>What’s your favorite visualization plot?</li>
  </ol>

  <blockquote class="solution">
    <div id="solution-3" class="box-title"><button type="button" aria-controls="solution-3-contents" aria-expanded="true" aria-label="Toggle solution box: "><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"></span> Solution<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li><em>Salmonella enterica</em> with 17,309 sequences</li>
      <li><em>Pseudomonas lundensis</em> with 13,227 sequences</li>
      <li>
        <p>All of them are good visualization of the data but for us to answer these questions, we used the <strong>Taxonomy Bar Chart</strong></p>

        <p><img src="./images/phinch_taxonomy_bar_chart.png" alt="Taxonomy Bar Chart. " loading="lazy" /></p>
      </li>
    </ol>

  </blockquote>
</blockquote>

<blockquote class="comment">
  <div id="comment-4" class="box-title" aria-label="comment box: "><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden"></span> Comment</div>
  <p>While these steps are running, you can move on to the next section <strong>Gene based pathogenic identification</strong> and run the steps there, as well. Both analyses can execute in parallel.</p>
</blockquote>

<h1 id="gene-based-pathogenic-identification">Gene based pathogenic identification</h1>

<p>With taxonomy profiling, we identified some bacterial species. But we want to be sure they are pathogenic, by <strong>looking for genes known to be linked to pathogenicity or to the pathogenecity character</strong> of the organim:</p>

<ul>
  <li><a href="https://www.sciencedirect.com/topics/immunology-and-microbiology/virulence-factor"><strong>Virulence Factor (VF)</strong></a>: gene products, usually proteins, involved in pathogenicity. By identifiying them we can call a pathogen and its severity level</li>
  <li>
    <p><a href="https://www.sciencedirect.com/topics/engineering/antibiotic-resistance-genes"><strong>Antimicrobial Resistance genes (AMR)</strong></a>.</p>

    <p>These type of genes have three fundamental mechanisms of antimicrobial resistance that are enzymatic degradation of antibacterial drugs, alteration of bacterial proteins that are antimicrobial targets, and changes in membrane permeability to antibiotics, which will lead to not altering the target site and spread throughput the pathogenic bacteria decreasing the overall fitness of the host.</p>
  </li>
</ul>

<p>To look for these genes and determine the strain of the bacteria we are testing for pathogenicity we use <strong>Multilocus Sequence Typing</strong> approach and dedicated <a href="https://pubmlst.org/">pubMLST datases</a> database:</p>

<ol>
  <li>Genome assembly to get contigs, i.e. longer sequences, using <strong>metaflye</strong> (<span class="citation"><a href="#flye">Kolmogorov <i>et al.</i> 2020</a></span>)  then assembly polishing using <a href="https://github.com/nanoporetech/medaka"><strong>medaka consensus pipeline</strong></a> and visualizing the assembly graph using <strong>Bandage Image</strong> (<span class="citation"><a href="#Wick2015">Wick <i>et al.</i> 2015</a></span>)</li>
  <li>Generate an <strong>MLST</strong> report with <strong>MLST</strong> tool that scans genomes against PubMLST schemes</li>
  <li>Generate reports with <strong>AMR</strong> genes and <strong>VF</strong> using <a href="https://github.com/tseemann/abricate"><strong>ABRicate</strong></a></li>
</ol>

<p>As outputs, we will get our <strong>FASTA</strong> and <strong>Tabular</strong> files to track genes and visualize our pathogenic identification. For that we will need one more file to create a report and we can upload it directly:</p>

<blockquote class="notranslate hands_on">
  <div id="hands-on-data-upload-1" class="box-title" aria-label="hands-on box: Data upload"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Data upload</div>

  <ol>
    <li>
      <p>Import a tabular file via link from <a href="https://zenodo.org/record/7593928">Zenodo</a> or shared data libraries</p>

      <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/7593928/files/MLST_Report_Header.tabular
</code></pre></div>      </div>
    </li>
    <li>
      <p>Check that the datatype is <code class="language-plaintext highlighter-rouge">Tabular</code></p>
    </li>
  </ol>
</blockquote>

<div class="Short-Version">

  <blockquote class="notranslate hands_on">
    <div id="hands-on-gene-based-pathogenic-identification" class="box-title" aria-label="hands-on box: Gene based Pathogenic Identification"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Gene based Pathogenic Identification</div>

    <ol>
      <li><strong>Import the <span class="notranslate">workflow</span></strong> into <span class="notranslate">Galaxy</span>
        <ul>
          <li>Copy the URL (e.g. via right-click) of <a href="/training-material/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/nanopore_gene_based_pathogenic_identification.ga">this <span class="notranslate">workflow</span></a> or download it to your computer.</li>
          <li>Import the <span class="notranslate">workflow</span> into <span class="notranslate">Galaxy</span></li>
        </ul>

        <!--SNIPPET-->
        <blockquote class="tip">   <div id="tip-importing-a-workflow-1" class="box-title"><button type="button" aria-controls="tip-importing-a-workflow-1-contents" aria-expanded="true" aria-label="Toggle tip box: Importing a workflow"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Importing a <span class="notranslate">workflow</span><span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <em><span class="notranslate">Workflow</span></em> on the top menu bar of <span class="notranslate">Galaxy</span>. You will see a list of all your workflows.</li>   <li>Click on the upload icon <i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-upload</span> at the top-right of the screen</li>   <li>Provide your <span class="notranslate">workflow</span>     <ul>       <li>Option 1: Paste the URL of the <span class="notranslate">workflow</span> into the box labelled <em>“Archived <span class="notranslate">Workflow</span> URL”</em></li>       <li>Option 2: Upload the <span class="notranslate">workflow</span> file in the box labelled <em>“Archived <span class="notranslate">Workflow</span> File”</em></li>     </ul>   </li>   <li>Click the <strong>Import <span class="notranslate">workflow</span></strong> button</li> </ul> </blockquote>
      </li>
      <li>Run <strong><span class="notranslate">Workflow</span> 3: Nanopore Datasets - Gene based Pathogenic Identification</strong> <i class="fas fa-share-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">workflow</span></span> using the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Nanopore Preprocessed <span class="notranslate">reads</span>”</em>: <code class="language-plaintext highlighter-rouge">Nanopore processed sequenced <span class="notranslate">reads</span></code> for <code class="language-plaintext highlighter-rouge">Barcode10</code></li>
          <li><em>“Sample ID”</em>: <code class="language-plaintext highlighter-rouge">Barcode10_Spike2</code></li>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“MLST Report Header”</em>: <code class="language-plaintext highlighter-rouge">MLST Report with Header</code></li>
        </ul>

        <!--SNIPPET-->
        <blockquote class="tip">   <div id="tip-running-a-workflow-2" class="box-title"><button type="button" aria-controls="tip-running-a-workflow-2-contents" aria-expanded="true" aria-label="Toggle tip box: Running a workflow"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Running a <span class="notranslate">workflow</span><span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <em><span class="notranslate">Workflow</span></em> on the top menu bar of <span class="notranslate">Galaxy</span>. You will see a list of all your workflows.</li>   <li>Click on the <i class="fas fa-play" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">workflow</span>-run</span> (<em>Run <span class="notranslate">workflow</span></em>) button next to your <span class="notranslate">workflow</span></li>   <li>Configure the <span class="notranslate">workflow</span> as needed</li>   <li>Click the <strong>Run <span class="notranslate">Workflow</span></strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>
      </li>
      <li>Repeat step 2 and run the same <strong><span class="notranslate">workflow</span></strong> again for the second tag
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Nanopore Preprocessed <span class="notranslate">reads</span>”</em>: <code class="language-plaintext highlighter-rouge">Nanopore processed sequenced <span class="notranslate">reads</span></code> for <code class="language-plaintext highlighter-rouge">Barcode11</code></li>
          <li><em>“Sample ID”</em>: <code class="language-plaintext highlighter-rouge">Barcode11_Spike2b</code></li>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“MLST Report Header”</em>: <code class="language-plaintext highlighter-rouge">MLST Report with Header</code></li>
        </ul>

        <!--SNIPPET-->
        <blockquote class="tip">   <div id="tip-running-a-workflow-3" class="box-title"><button type="button" aria-controls="tip-running-a-workflow-3-contents" aria-expanded="true" aria-label="Toggle tip box: Running a workflow"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Running a <span class="notranslate">workflow</span><span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <em><span class="notranslate">Workflow</span></em> on the top menu bar of <span class="notranslate">Galaxy</span>. You will see a list of all your workflows.</li>   <li>Click on the <i class="fas fa-play" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">workflow</span>-run</span> (<em>Run <span class="notranslate">workflow</span></em>) button next to your <span class="notranslate">workflow</span></li>   <li>Configure the <span class="notranslate">workflow</span> as needed</li>   <li>Click the <strong>Run <span class="notranslate">Workflow</span></strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>
      </li>
    </ol>

  </blockquote>

</div>

<h2 id="assembly">Assembly</h2>

<p>To identify VF or AMR genes, it is better to assemble <span class="notranslate">reads</span> into longer seuqences or contigs, that can be then used to search databases for the presence of any pathogenic gene:</p>

<ul>
  <li>
    <p>Assembly of long-read metagenomic data using <strong>metaflye</strong> or <strong>Flye</strong>.</p>

    <div class="Long-Version">

      <blockquote class="hands-on">
        <div id="hands-on-assembly-with-flye" class="box-title" aria-label="hands-on box:  Assembly with Flye "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Assembly with Flye</div>

        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/flye/flye/2.9+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/flye/flye/2.9+galaxy0"><strong>Flye</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/flye/flye/2.9+<span class="notranslate">galaxy</span>0</span></span>  with the following parameters:
            <ul>
              <li>
                <p><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Input <span class="notranslate">reads</span>”</em>: Outputs without matched ID of <strong>Filter sequences by ID</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> for <code class="language-plaintext highlighter-rouge">Barcode10</code></p>

                <blockquote class="comment">
                  <div id="comment-5" class="box-title" aria-label="comment box: "><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden"></span> Comment</div>
                  <p>We need to run <strong>Flye</strong> individually on each sample otherwise <strong>Flye</strong> runs by default a co-assembly mode, <em>i.e.</em> it combines read of both samples together before running the assembly.</p>
                </blockquote>
              </li>
              <li><em>“Mode”</em>: <code class="language-plaintext highlighter-rouge">Nanopore HQ (--nano-hq)</code></li>
              <li><em>“Perform metagenomic assembly”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
              <li><em>“Reduced contig assembly coverage”</em>: <code class="language-plaintext highlighter-rouge">Disable reduced coverage for initial disjointing assembly</code></li>
            </ul>
          </li>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/flye/flye/2.9+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/flye/flye/2.9+galaxy0"><strong>Flye</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/flye/flye/2.9+<span class="notranslate">galaxy</span>0</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Input <span class="notranslate">reads</span>”</em>: Outputs without matched ID of <strong>Filter sequences by ID</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> for <code class="language-plaintext highlighter-rouge">Barcode11</code></li>
              <li><em>“Mode”</em>: <code class="language-plaintext highlighter-rouge">Nanopore HQ (--nano-hq)</code></li>
              <li><em>“Perform metagenomic assembly”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
              <li><em>“Reduced contig assembly coverage”</em>: <code class="language-plaintext highlighter-rouge">Disable reduced coverage for initial disjointing assembly</code></li>
            </ul>
          </li>
        </ol>
      </blockquote>

    </div>
  </li>
  <li>
    <p>For the visualization of the assembly graph output from <strong>Flye</strong> we have chosen <strong>Bandage Image</strong>.</p>

    <div class="Long-Version">

      <blockquote class="hands-on">
        <div id="hands-on-visualization-of-the-assembly-grap" class="box-title" aria-label="hands-on box:  Visualization of the assembly grap "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Visualization of the assembly grap</div>
        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/0.8.1+galaxy2" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/0.8.1+galaxy2"><strong>Bandage Image</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/0.8.1+<span class="notranslate">galaxy</span>2</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Graphical Fragment Assembly”</em>: Assembly graph outputs of <strong>Flye</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
            </ul>
          </li>
        </ol>
      </blockquote>

    </div>
  </li>
  <li>
    <p>Contig polishing using <strong>medaka</strong> to correct the long, error-prone Nanopore <span class="notranslate">reads</span></p>

    <div class="Long-Version">

      <blockquote class="hands-on">
        <div id="hands-on-contig-polishing" class="box-title" aria-label="hands-on box:  Contig polishing "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Contig polishing</div>

        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/medaka_consensus_pipeline/medaka_consensus_pipeline/1.7.2+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/medaka_consensus_pipeline/medaka_consensus_pipeline/1.7.2+galaxy0"><strong>medaka consensus pipeline</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/medaka_consensus_pipeline/medaka_consensus_pipeline/1.7.2+<span class="notranslate">galaxy</span>0</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Select basecalls”</em>: Outputs without matched ID of <strong>Filter sequences by ID</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Select assembly”</em>: Output of <strong>Flye</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li><em>“Select model”</em>: <code class="language-plaintext highlighter-rouge">r941_min_hac_g507</code></li>
              <li><em>“Select output file(s)”</em>: <code class="language-plaintext highlighter-rouge">select all</code></li>
            </ul>
          </li>
        </ol>
      </blockquote>

      <p>To keep information about the provenance of the contigs, we can rename them to add contig information to them.</p>

      <blockquote class="hands-on">
        <div id="hands-on-contig-renaming-to-add-sample-names" class="box-title" aria-label="hands-on box:  Contig renaming to add sample names "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Contig renaming to add sample names</div>
        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/fasta_to_tabular/fasta2tab/1.1.1" title="Tested with toolshed.g2.bx.psu.edu/repos/devteam/fasta_to_tabular/fasta2tab/1.1.1"><strong>FASTA-to-Tabular</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/devteam/fasta_to_tabular/fasta2tab/1.1.1</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Convert these sequences”</em>: output of <strong>medaka consensus pipeline</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
            </ul>
          </li>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4"><strong>Replace</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File to process”</em>: output of <strong>FASTA-to-Tabular</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> for <code class="language-plaintext highlighter-rouge">Barcode10</code></li>
              <li>In <em>“Find and Replace”</em>:
                <ul>
                  <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert Find and Replace”</em>
                    <ul>
                      <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">^(.+)$</code></li>
                      <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">Barcode10_$1</code></li>
                      <li><em>“Find-Pattern is a regular <span class="notranslate">expression</span>”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                      <li><em>“Replace all occurences of the pattern”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                      <li><em>“Find and Replace text in”</em>: <code class="language-plaintext highlighter-rouge">specific column</code>
                        <ul>
                          <li><em>“in column”</em>: <code class="language-plaintext highlighter-rouge">Column: 1</code></li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li>
            <p>Rename the output to <code class="language-plaintext highlighter-rouge">Contigs Table - Barcode10</code></p>

            <!--SNIPPET-->
            <blockquote class="tip">   <div id="tip-renaming-a-dataset" class="box-title"><button type="button" aria-controls="tip-renaming-a-dataset-contents" aria-expanded="true" aria-label="Toggle tip box: Renaming a dataset"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Renaming a dataset<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>
          </li>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4"><strong>Replace</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File to process”</em>: output of <strong>FASTA-to-Tabular</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> for <code class="language-plaintext highlighter-rouge">Barcode11</code></li>
              <li>In <em>“Find and Replace”</em>:
                <ul>
                  <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert Find and Replace”</em>
                    <ul>
                      <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">^(.+)$</code></li>
                      <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">Barcode11_$1</code></li>
                      <li><em>“Find-Pattern is a regular <span class="notranslate">expression</span>”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                      <li><em>“Replace all occurences of the pattern”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                      <li><em>“Find and Replace text in”</em>: <code class="language-plaintext highlighter-rouge">specific column</code>
                        <ul>
                          <li><em>“in column”</em>: <code class="language-plaintext highlighter-rouge">Column: 1</code></li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li>
            <p>Rename the output to <code class="language-plaintext highlighter-rouge">Contigs Table - Barcode11</code></p>

            <!--SNIPPET-->
            <blockquote class="tip">   <div id="tip-renaming-a-dataset-1" class="box-title"><button type="button" aria-controls="tip-renaming-a-dataset-1-contents" aria-expanded="true" aria-label="Toggle tip box: Renaming a dataset"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Renaming a dataset<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field</li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>
          </li>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/tabular_to_fasta/tab2fasta/1.1.1" title="Tested with toolshed.g2.bx.psu.edu/repos/devteam/tabular_to_fasta/tab2fasta/1.1.1"><strong>Tabular-to-FASTA</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/devteam/tabular_to_fasta/tab2fasta/1.1.1</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Tab-delimited file”</em>: outputs of <strong>Replace</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li><em>“Title column(s)”</em>: <code class="language-plaintext highlighter-rouge">Column: 1</code></li>
              <li><em>“Sequence column”</em>: <code class="language-plaintext highlighter-rouge">Column: 2</code></li>
            </ul>
          </li>
          <li>Rename the outputs to <code class="language-plaintext highlighter-rouge">Contigs - Barcode10</code> and <code class="language-plaintext highlighter-rouge">Contigs - Barcode11</code></li>
        </ol>
      </blockquote>

    </div>
  </li>
</ul>

<blockquote class="question">
  <div id="question-4" class="box-title" aria-label="question box: "><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Question</div>

  <p>Inspect <strong>Flye</strong> and <strong>Medaka consensus pipeline</strong> output results for <code class="language-plaintext highlighter-rouge">Barcode10</code></p>

  <ol>
    <li>How many different contigs did you get after <strong>Flye</strong>?</li>
    <li>How many were left after <strong>Medaka consensus pipeline</strong>, and what does that mean?</li>
    <li>What is the result of your <strong>Bandage Image</strong>?</li>
  </ol>

  <blockquote class="solution">
    <div id="solution-4" class="box-title"><button type="button" aria-controls="solution-4-contents" aria-expanded="true" aria-label="Toggle solution box: "><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"></span> Solution<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>After <strong>Flye</strong> we have got 137 contigs</li>
      <li>After <strong>Medaka consensus pipeline</strong> all 137 contigs were kept, which means that the quality of the <strong>Flye</strong> run was high, and as a result the polishing did not remove any of the contigs.</li>
      <li>
        <p>The graph looks like:</p>

        <p><img src="./images/bandage_image_flye_graph.png" alt="Bandage Image Barcode 10 Assembly Graph. " loading="lazy" /></p>
      </li>
    </ol>

  </blockquote>
</blockquote>

<h2 id="multilocus-sequence-typing">Multilocus Sequence Typing</h2>

<p><strong>MLST</strong> tool is used to scan the <a href="https://pubmlst.org/">pubMLST</a> database against PubMLST typing schemes. It’s one of the analyses that you can perform on your dataset to determine the allele IDs, you can also detect novel alleles. This step is not essential to identify pathogens and track them in the remainder of this tutorial, however we wanted to show some of the analysis that one can use <span class="notranslate">Galaxy</span> in to understand more about the dataset, as well as identifying the strain that might be a pathogen or not.</p>

<div class="Long-Version">

  <blockquote class="hands-on">
    <div id="hands-on-multilocus-sequence-typing" class="box-title" aria-label="hands-on box:  Multilocus Sequence Typing "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Multilocus Sequence Typing</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/mlst/mlst/2.22.0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/mlst/mlst/2.22.0"><strong>MLST</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/mlst/mlst/2.22.0</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“input_files”</em>:  Sample Specific <code class="language-plaintext highlighter-rouge">Contigs-BarcodeXX</code> FASTA files with contigs</li>
          <li><em>“Specify advanced parameters”</em>: <code class="language-plaintext highlighter-rouge">Yes, see full parameter list</code>
            <ul>
              <li><em>“Output novel alleles”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
              <li><em>“Automatically set MLST scheme”</em>: <code class="language-plaintext highlighter-rouge">Automatic MLST scheme detection</code></li>
            </ul>
          </li>
        </ul>
      </li>
    </ol>

  </blockquote>

</div>

<p>The output file of the <strong>MLST</strong> tool is a tab-separated output file which contains:</p>
<ul>
  <li>the filename</li>
  <li>the closest PubMLST scheme name</li>
  <li>the ST (sequence type)</li>
  <li>the allele IDs</li>
</ul>

<blockquote class="question">
  <div id="question-5" class="box-title" aria-label="question box: "><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Question</div>

  <p>Inspect <strong>MLST</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> results</p>

  <ol>
    <li>What is the the closest PubMLST typing scheme name detected by the tool for  <code class="language-plaintext highlighter-rouge">Barcode11</code>?</li>
  </ol>

  <blockquote class="solution">
    <div id="solution-5" class="box-title"><button type="button" aria-controls="solution-5-contents" aria-expanded="true" aria-label="Toggle solution box: "><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"></span> Solution<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>senterica_achtman_2 (<span class="citation"><a href="#sentericaachtman2">“<b>Multilocus Sequence Typing as a Replacement for Serotyping in Salmonella enterica</b>” 2012</a></span>)</li>
    </ol>

  </blockquote>
</blockquote>

<h2 id="antimicrobial-resistance-genes">Antimicrobial Resistance Genes</h2>

<p>Now, to search <strong>AMR</strong> genes among our samples’ contigs, we run <strong>ABRicate</strong> and choose the <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6811410/"><strong>NCBI Bacterial Antimicrobial Resistance Gene Database (AMRFinderPlus)</strong></a> from the advanced options of the tool. The tool checks if there is an AMR found or not, if found then in which contig it is, its location on the contig, what the name of the exact product is, what substance it provides resistance against and a lot of other information regarding the found <strong>AMR</strong>.</p>

<div class="Long-Version">

  <blockquote class="hands-on">
    <div id="hands-on-antimicrobial-resistance-genes-identification" class="box-title" aria-label="hands-on box:  Antimicrobial Resistance Genes Identification "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Antimicrobial Resistance Genes Identification</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/abricate/abricate/1.0.1" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/abricate/abricate/1.0.1"><strong>ABRicate</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/abricate/abricate/1.0.1</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Input file (Fasta, Genbank or EMBL file)”</em>: Sample Specific <code class="language-plaintext highlighter-rouge">Contigs-BarcodeXX</code> FASTA files with contigs</li>
          <li>In <em>“Advanced options”</em>:
            <ul>
              <li><em>“Database to use - default is ‘resfinder’“</em>: <code class="language-plaintext highlighter-rouge">NCBI Bacterial Antimicrobial Resistance Reference Gene Database</code></li>
            </ul>
          </li>
        </ul>
      </li>
      <li>Rename the generated files <code class="language-plaintext highlighter-rouge">AMR - Barcode10</code> and <code class="language-plaintext highlighter-rouge">AMR - Barcode11</code></li>
    </ol>
  </blockquote>

</div>

<p>The outputs of <strong>ABRicate</strong> is a tabular file with different columns:</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">FILE</code>: The filename this hit came from</li>
  <li><code class="language-plaintext highlighter-rouge">SEQUENCE</code>: The sequence in the filename</li>
  <li><code class="language-plaintext highlighter-rouge">START</code>: Start coordinate in the sequence</li>
  <li><code class="language-plaintext highlighter-rouge">END</code>: End coordinate</li>
  <li><code class="language-plaintext highlighter-rouge">STRAND</code>: AMR gene</li>
  <li><code class="language-plaintext highlighter-rouge">GENE</code>: AMR gene</li>
  <li><code class="language-plaintext highlighter-rouge">COVERAGE</code>: What proportion of the gene is in our sequence</li>
  <li><code class="language-plaintext highlighter-rouge">COVERAGE_MA</code>: A visual represenation</li>
  <li><code class="language-plaintext highlighter-rouge">GAPS</code>: Was there any gaps in the alignment - possible pseudogene?</li>
  <li><code class="language-plaintext highlighter-rouge">%COVERAGE</code>: Proportion of gene covered</li>
  <li><code class="language-plaintext highlighter-rouge">%IDENTITY</code>: Proportion of exact nucleotide matches</li>
  <li><code class="language-plaintext highlighter-rouge">DATABASE</code>: The database this sequence comes from</li>
  <li><code class="language-plaintext highlighter-rouge">ACCESSION</code>: The genomic source of the sequence</li>
  <li><code class="language-plaintext highlighter-rouge">PRODUCT</code></li>
  <li><code class="language-plaintext highlighter-rouge">RESISTANCE</code></li>
</ol>

<!--<div class="Long-Version" markdown="1">

> <div id="hands-on-antimicrobial-resistance-genes-identification-1" class="box-title" aria-label="hands-on box:  Antimicrobial Resistance Genes Identification "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Antimicrobial Resistance Genes Identification</div>
> 2. <span class="tool" data-tool="Cut1" title="Tested with Cut1"><strong>Cut</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: Cut1</span></span>  with the following parameters:
>    - *"Cut columns"*: `c13`
>    - <i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> *"From"*: `report` (output of the **ABRicate** <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> run)
>
> 3. <span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/add_line_to_file/add_line_to_file/0.1.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/add_line_to_file/add_line_to_file/0.1.0"><strong>Add line to file</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/add_line_to_file/add_line_to_file/0.1.0</span></span>  with the following parameters:
>    - *"text to add"*: `Spike2Barcode10` or `Spike2bBarcode11` respectively to the tag chosen for the first parameter (the sample ID)
>    - <i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> *"input file"*: `out_file1` (output of the **Cut** <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>)
{: .hands-on}

</div>-->

<blockquote class="question">
  <div id="question-6" class="box-title" aria-label="question box: "><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Question</div>

  <p>Inspect <strong>ABRicate</strong> output files from <code class="language-plaintext highlighter-rouge">Barcode10</code>and <code class="language-plaintext highlighter-rouge">Barcode11</code> tags</p>

  <ol>
    <li>How many <strong>AMR</strong> genes found in <code class="language-plaintext highlighter-rouge">Barcode10</code> sample, what are they? Give more details about them.</li>
    <li>How many <strong>AMR</strong> genes found in <code class="language-plaintext highlighter-rouge">Barcode11</code> sample, what are they? Give more details about them.</li>
  </ol>

  <blockquote class="solution">
    <div id="solution-6" class="box-title"><button type="button" aria-controls="solution-6-contents" aria-expanded="true" aria-label="Toggle solution box: "><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"></span> Solution<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>5 <strong>AMR</strong> genes were found:
        <ol>
          <li>Tet(C), which resists <a href="https://medlineplus.gov/druginfo/meds/a682098.html">TETRACYCLINE</a>. It was found in contig 158 from the position 1633 till 2808, with 100% coverage, so 100% of gene is covered in this contig.</li>
          <li>2 genes with sulfonamide-resistant dihydropteroate synthase Sul1 products</li>
          <li>2 genes with oxacillin-hydrolyzing class D beta-lactamase OXA-2 products</li>
        </ol>
      </li>
      <li>No <strong>AMR</strong> genes were found by the database in <code class="language-plaintext highlighter-rouge">Barcode11_Spike2b</code> sample.</li>
    </ol>

  </blockquote>
</blockquote>

<h2 id="virulence-factor-identification">Virulence Factor identification</h2>

<p>In this step we return back to the main goal of the tutorial where we want to identify the pathogens: <strong>identify if the bacteria found in our samples are pathogenic bacteria or not</strong>. One of the ways to do that is to identify if the sequences include genes with a <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2646308/">Virulence Facor</a> or not, such that if the samples include gene(s) with a Virulence Factor then it for sure is a pathogen.</p>

<blockquote class="comment">
  <div id="comment-definitions" class="box-title" aria-label="comment box: Definitions"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden"></span> Comment: Definitions</div>

  <p><strong>Bacterial Pathogen</strong>: A bacterial pathogen is usually defined as any bacterium that has the capacity to cause disease. Its ability to cause disease is called pathogenicity.</p>

  <p><strong>Virulence</strong>: Virulence provides a quantitative measure of the pathogenicity or the likelihood of causing a disease.</p>

  <p><strong>Virulence Factors</strong>: Virulence factors refer to the properties (i.e., gene products) that enable a microorganism to establish itself on or within a host of a particular species and enhance its potential to cause disease. Virulence factors include bacterial toxins, cell surface proteins that mediate bacterial attachment, cell surface carbohydrates and proteins that protect a bacterium, and hydrolytic enzymes that may contribute to the pathogenicity of the bacterium.</p>

</blockquote>

<p>To identifly VFs, we use again <strong>ABRicate</strong> but this time with the <a href="https://pubmed.ncbi.nlm.nih.gov/26578559/"><strong>VFDB</strong></a> from the advanced options of the tool.</p>

<div class="Long-Version">

  <blockquote class="hands-on">
    <div id="hands-on-virulence-factor-identification" class="box-title" aria-label="hands-on box:  Virulence Factor identification "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Virulence Factor identification</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/abricate/abricate/1.0.1" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/abricate/abricate/1.0.1"><strong>ABRicate</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/abricate/abricate/1.0.1</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Input file (Fasta, Genbank or EMBL file)”</em>:   Sample Specific <code class="language-plaintext highlighter-rouge">Contigs-BarcodeXX</code> FASTA files with contigs</li>
          <li>In <em>“Advanced options”</em>:
            <ul>
              <li><em>“Database to use - default is ‘resfinder’“</em>: <code class="language-plaintext highlighter-rouge">VFDB</code></li>
            </ul>
          </li>
        </ul>
      </li>
      <li>Rename the generated files <code class="language-plaintext highlighter-rouge">VFs - Barcode10</code> and <code class="language-plaintext highlighter-rouge">VFs - Barcode11</code></li>
    </ol>
  </blockquote>

</div>

<blockquote class="question">
  <div id="question-7" class="box-title" aria-label="question box: "><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Question</div>

  <p>Inspect <strong>VFs of genes Identified by VFDB</strong> output file from<code class="language-plaintext highlighter-rouge">Barcode10</code>and <code class="language-plaintext highlighter-rouge">Barcode11</code> tags</p>

  <ol>
    <li>How many different <strong>VFs</strong> gene products were found in <code class="language-plaintext highlighter-rouge">Barcode10_Spike2</code> sample?</li>
    <li>How many different <strong>VFs</strong> gene products were found in <code class="language-plaintext highlighter-rouge">Barcode11_Spike2b</code> sample?</li>
  </ol>

  <blockquote class="solution">
    <div id="solution-7" class="box-title"><button type="button" aria-controls="solution-7-contents" aria-expanded="true" aria-label="Toggle solution box: "><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"></span> Solution<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>123</li>
      <li>97</li>
    </ol>

  </blockquote>
</blockquote>

<div class="Long-Version">

  <blockquote class="hands-on">
    <div id="hands-on-formatting" class="box-title" aria-label="hands-on box:  Formatting "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Formatting</div>
    <ol>
      <li><span class="tool" data-tool="Cut1" title="Tested with Cut1"><strong>Cut</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: Cut1</span></span>  with the following parameters:
        <ul>
          <li><em>“Cut columns”</em>: <code class="language-plaintext highlighter-rouge">c13</code></li>
          <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“From”</em>: outputs of <strong>ABRicate</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        </ul>
      </li>
      <li>
        <p>Rename the outputs <code class="language-plaintext highlighter-rouge">VFs accessions - Barcode10</code> and <code class="language-plaintext highlighter-rouge">VFs accessions - Barcode11</code></p>
      </li>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/add_line_to_file/add_line_to_file/0.1.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/add_line_to_file/add_line_to_file/0.1.0"><strong>Add line to file</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/add_line_to_file/add_line_to_file/0.1.0</span></span>  with the following parameters:
        <ul>
          <li><em>“text to add”</em>: <code class="language-plaintext highlighter-rouge">Barcode10</code></li>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“input file”</em>: <code class="language-plaintext highlighter-rouge">VFs accessions - Barcode10</code></li>
        </ul>
      </li>
      <li>
        <p>Rename the output <code class="language-plaintext highlighter-rouge">VFs accessions with SampleID as a header- Barcode10</code></p>
      </li>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/add_line_to_file/add_line_to_file/0.1.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/add_line_to_file/add_line_to_file/0.1.0"><strong>Add line to file</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/add_line_to_file/add_line_to_file/0.1.0</span></span>  with the following parameters:
        <ul>
          <li><em>“text to add”</em>: <code class="language-plaintext highlighter-rouge">Barcode11</code></li>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“input file”</em>: <code class="language-plaintext highlighter-rouge">VFs accessions - Barcode11</code></li>
        </ul>
      </li>
      <li>Rename the output <code class="language-plaintext highlighter-rouge">VFs accessions with SampleID as a header- Barcode11</code></li>
    </ol>
  </blockquote>

</div>

<h1 id="snp-based-pathogenic-identification">SNP based pathogenic identification</h1>

<p>Now we would like to identify pathogens with a third approach based on variant and <a href="https://genome.sph.umich.edu/w/images/e/e6/Seqshop_may_2015_day2_snp_lecture_v2.pdf">single nucleotide polymorphisms (SNPs) calling</a>: comparison of <span class="notranslate">reads</span> to a targeted reference genome, and call the differences between sample <span class="notranslate">reads</span> and reference genomes to identify variants.</p>

<p>For example, if we want to check whether our samples include <a href="https://www.cdc.gov/campylobacter/index.html"><em>Campylobacter</em> pathogenic strains</a> or not, we will map our samples against the reference genome of the <em>Campylobacter</em> species. Variants in specific positions on the genome are queried to judge if these variations would indicate a pathogen or not.</p>

<p>This approach also allows identification of novel alleles and possible <strong>new variants of the pathogen</strong>.</p>

<p>Using this approach, we also build the consensus genome of each sample, so we can later build a phylogenetic tree of all samples’ full genomes and have an insight into events that occurred during the evolution of same or different species in the samples.</p>

<p>In this training, we are testing <em>Salmonella enterica</em>, with different strains of which our samples were spiked. So we will now upload to our history the reference genome of <a href="https://www.ncbi.nlm.nih.gov/genome/?term=txid99287[Organism:exp]"><em>S. enterica</em></a> we originally obtained from the <a href="https://www.ncbi.nlm.nih.gov/">National Center for Biotechnology Information (NCBI) database</a>.</p>

<blockquote class="notranslate hands_on">
  <div id="hands-on-data-upload-2" class="box-title" aria-label="hands-on box: Data upload"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Data upload</div>

  <ol>
    <li>
      <p>Import a reference genome FASTA file via link from <a href="https://zenodo.org/record/7593928">Zenodo</a> or <span class="notranslate">Galaxy</span> shared data libraries</p>

      <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/7593928/files/Salmonella_Ref_genome.fna.gz
</code></pre></div>      </div>
    </li>
  </ol>

</blockquote>

<div class="Short-Version">

  <blockquote class="notranslate hands_on">
    <div id="hands-on-snp-based-pathogenic-identification" class="box-title" aria-label="hands-on box: SNP based Pathogenic Identification"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: SNP based Pathogenic Identification</div>

    <ol>
      <li><strong>Import the <span class="notranslate">workflow</span></strong> into <span class="notranslate">Galaxy</span>
        <ul>
          <li>Copy the URL (e.g. via right-click) of <a href="/training-material/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/nanopore_snp_based_pathogenetic_identification.ga">this <span class="notranslate">workflow</span></a> or download it to your computer.</li>
          <li>Import the <span class="notranslate">workflow</span> into <span class="notranslate">Galaxy</span></li>
        </ul>

        <!--SNIPPET-->
        <blockquote class="tip">   <div id="tip-importing-a-workflow-2" class="box-title"><button type="button" aria-controls="tip-importing-a-workflow-2-contents" aria-expanded="true" aria-label="Toggle tip box: Importing a workflow"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Importing a <span class="notranslate">workflow</span><span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <em><span class="notranslate">Workflow</span></em> on the top menu bar of <span class="notranslate">Galaxy</span>. You will see a list of all your workflows.</li>   <li>Click on the upload icon <i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-upload</span> at the top-right of the screen</li>   <li>Provide your <span class="notranslate">workflow</span>     <ul>       <li>Option 1: Paste the URL of the <span class="notranslate">workflow</span> into the box labelled <em>“Archived <span class="notranslate">Workflow</span> URL”</em></li>       <li>Option 2: Upload the <span class="notranslate">workflow</span> file in the box labelled <em>“Archived <span class="notranslate">Workflow</span> File”</em></li>     </ul>   </li>   <li>Click the <strong>Import <span class="notranslate">workflow</span></strong> button</li> </ul> </blockquote>
      </li>
      <li>Run <strong><span class="notranslate">Workflow</span> 4: Nanopore Datasets - SNP based Pathogenic Identification</strong> <i class="fas fa-share-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">workflow</span></span> using the following parameters:
        <ul>
          <li><em>“Send results to a new history”</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
          <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Nanopore Preprocessed <span class="notranslate">reads</span>”</em>: <code class="language-plaintext highlighter-rouge">Nanopore processed sequenced <span class="notranslate">reads</span></code></li>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Reference Genome of Tested Strain/Pathogen”</em>: <code class="language-plaintext highlighter-rouge">Salmonella_Ref_genome.fna.gz</code></li>
        </ul>
      </li>
    </ol>

  </blockquote>

</div>

<h2 id="variant-calling-or-snp-calling">Variant Calling or SNP Calling</h2>

<p>To identify variants, we</p>

<ol>
  <li>
    <p><strong>Map <span class="notranslate">reads</span> to the reference genome</strong> of the species of the pathogen we want to test our samples against using <strong>Minimap2</strong> (<span class="citation"><a href="#Li2017Minimap2">Li 2017</a></span>) as our datasets are from a Nanopore:</p>

    <div class="Long-Version">

      <blockquote class="hands-on">
        <div id="hands-on-mapping-to-reference-genome" class="box-title" aria-label="hands-on box:  Mapping to reference genome "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  <span class="notranslate">Mapping</span> to reference genome</div>
        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/2.24+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/2.24+galaxy0"><strong>Map with minimap2</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/2.24+<span class="notranslate">galaxy</span>0</span></span>  with the following parameters:
            <ul>
              <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class="language-plaintext highlighter-rouge">Use a genome from history and build index</code>
                <ul>
                  <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Use the following dataset as the reference sequence”</em>: <code class="language-plaintext highlighter-rouge">Salmonella_Ref_genome.fna.gz</code></li>
                </ul>
              </li>
              <li><em>“Single or Paired-end <span class="notranslate">reads</span>”</em>: <code class="language-plaintext highlighter-rouge">Single</code>
                <ul>
                  <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Select fastq dataset”</em>: Outputs without matched ID of <strong>Filter sequences by ID</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> for <code class="language-plaintext highlighter-rouge">Barcode10</code> and <code class="language-plaintext highlighter-rouge">Barcode11</code></li>
                </ul>
              </li>
            </ul>
          </li>
        </ol>
      </blockquote>

    </div>
  </li>
  <li>
    <p><strong>Identify variants and single nucleotide variants</strong> using <strong>Clair3</strong> (<span class="citation"><a href="#Zheng2021">Zheng <i>et al.</i> 2021</a></span>), which is designed specifically for Nanopore datasets and giving better results than other variant calling tools, as well as being new and up-to-date.</p>

    <blockquote class="comment-on">
      <div id="comment-6" class="box-title" aria-label="comment box: "><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden"></span> Comment</div>
      <p><a href="https://github.com/nanoporetech/medaka"><strong>Medaka consensus tool</strong> and <strong>medaka variant tool</strong></a> can be also used instead of <strong>Clair3</strong>, they give similar results but they are much slower then <strong>Clair3</strong> and offer fewer options.</p>
    </blockquote>

    <div class="Long-Version">

      <blockquote class="hands-on">
        <div id="hands-on-variant-or-snp-calling" class="box-title" aria-label="hands-on box:  Variant or SNP Calling "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Variant or SNP Calling</div>
        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/clair3/clair3/0.1.12+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/clair3/clair3/0.1.12+galaxy0"><strong>Clair3</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/clair3/clair3/0.1.12+<span class="notranslate">galaxy</span>0</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“BAM/CRAM file input”</em>: Outputs of <strong>Map with minimap2</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li><em>“Reference genome source”</em>: <code class="language-plaintext highlighter-rouge">History</code>
                <ul>
                  <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Reference genome”</em>: <code class="language-plaintext highlighter-rouge">Salmonella_Ref_genome.fna.gz</code></li>
                </ul>
              </li>
              <li><em>“Clair3 model”</em>: <code class="language-plaintext highlighter-rouge">Built-in</code>
                <ul>
                  <li><em>“Built-in model”</em>: <code class="language-plaintext highlighter-rouge">r941_prom_hac_g360+g422</code></li>
                </ul>
              </li>
              <li>In <em>“Advanced parameters”</em>:
                <ul>
                  <li><em>“Call with the following ploidy model”</em>: <code class="language-plaintext highlighter-rouge">haploid precise (--haploid_precise)</code></li>
                </ul>
              </li>
            </ul>
          </li>
        </ol>
      </blockquote>

    </div>
  </li>
  <li>
    <p><strong>Left-align and normalize indels</strong> using <strong>bcftools norm</strong> (<span class="citation"><a href="#Li20092">Li <i>et al.</i> 2009</a></span>)</p>

    <p>This step:</p>
    <ul>
      <li>checks REF alleles in the output match the reference;</li>
      <li>splits multiallelic sites into multiple rows;</li>
      <li>recovers multiallelics from multiple rows</li>
    </ul>

    <div class="Long-Version">

      <blockquote class="hands-on">
        <div id="hands-on-left-align-and-normalize-indels" class="box-title" aria-label="hands-on box: Left-align and normalize indels"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Left-align and normalize indels</div>
        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/bcftools_norm/bcftools_norm/1.9+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/bcftools_norm/bcftools_norm/1.9+galaxy1"><strong>bcftools norm</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/bcftools_norm/bcftools_norm/1.9+<span class="notranslate">galaxy</span>1</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“VCF/BCF Data”</em>: Outputs of <strong>Clair3</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li><em>“Choose the source for the reference genome”</em>: <code class="language-plaintext highlighter-rouge">Use a genome from the history</code>
                <ul>
                  <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Reference genome”</em>: <code class="language-plaintext highlighter-rouge">Salmonella_Ref_genome.fna.gz</code></li>
                </ul>
              </li>
              <li><em>“output_type”</em>: <code class="language-plaintext highlighter-rouge">uncompressed VCF</code></li>
            </ul>
          </li>
        </ol>
      </blockquote>

    </div>
  </li>
  <li>
    <p><strong>Filter variants</strong> to keep only the pass and good quality variants using <strong>SnpSift Filter</strong> (<span class="citation"><a href="#Cingolani2012">Cingolani <i>et al.</i> 2012</a></span>)</p>

    <blockquote class="comment-on">
      <div id="comment-7" class="box-title" aria-label="comment box: "><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden"></span> Comment</div>
      <p><a href="https://csb5.github.io/lofreq/"><strong>LoFreq filter</strong></a> can be also used instead, both tools performs equal and fast results.</p>
    </blockquote>

    <div class="Long-Version">

      <blockquote class="hands-on">
        <div id="hands-on-filter-variants" class="box-title" aria-label="hands-on box: Filter variants"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Filter variants</div>
        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_filter/4.3+t.galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_filter/4.3+t.galaxy1"><strong>SnpSift Filter</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_filter/4.3+t.<span class="notranslate">galaxy</span>1</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Input variant list in VCF format”</em>: Outputs of <strong>bcftools norm</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li><em>“Type of filter <span class="notranslate">expression</span>”</em>: <code class="language-plaintext highlighter-rouge">Simple <span class="notranslate">expression</span></code>
                <ul>
                  <li><em>“Filter criteria”</em>: <code class="language-plaintext highlighter-rouge">(QUAL &gt; 2)</code></li>
                </ul>
              </li>
              <li><em>“Filter mode”</em>: <code class="language-plaintext highlighter-rouge">Retain selected variants, remove others</code></li>
            </ul>
          </li>
        </ol>
      </blockquote>

    </div>

    <p>The output is a VCF file. VCF is the standard file format for storing variation data, with different columns:</p>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">#CHROM</code>: Chromosome</li>
      <li><code class="language-plaintext highlighter-rouge">POS</code>: Co-ordinate - The start coordinate of the variant.</li>
      <li><code class="language-plaintext highlighter-rouge">ID</code>: Identifier</li>
      <li><code class="language-plaintext highlighter-rouge">REF</code>: Reference allele - The reference allele is whatever is found in the reference genome. It is not necessarily the major allele.</li>
      <li><code class="language-plaintext highlighter-rouge">ALT</code>: Alte<span class="notranslate">rna</span>tive allele - The alte<span class="notranslate">rna</span>tive allele is the allele found in the sample you are studying.</li>
      <li><code class="language-plaintext highlighter-rouge">QUAL</code>: Score - Quality score out of 100.</li>
      <li><code class="language-plaintext highlighter-rouge">FILTER</code>: Pass/fail - If it passed quality filters.</li>
      <li><code class="language-plaintext highlighter-rouge">INFO</code>: Further information - Allows you to provide further information on the variants. Keys in the INFO field can be defined in header lines above thetable.</li>
      <li><code class="language-plaintext highlighter-rouge">FORMAT</code>: Information about the following columns - The GT in the FORMAT column tells us to expect genotypes in the following columns.</li>
      <li><code class="language-plaintext highlighter-rouge">Individual identifier (optional)</code> - The previous column told us to expect to see genotypes here. The genotype is in the form “0|1”, where 0 indicates the reference allele and 1 indicates the alte<span class="notranslate">rna</span>tive allele, i.e it is heterozygous. The vertical pipe “|” indicates that the genotype is phased, and is used to indicate which chromosome the alleles are on. If this is a slash (/) rather than a vertical pipe, it means we don’t know which chromosome they are on.</li>
    </ul>
  </li>
  <li>
    <p><strong>Extract a tabular report</strong> with Chromosome, Position, Identifier, Reference allele, Alte<span class="notranslate">rna</span>tive allele and Filter from the VCF files using <a href="http://pcingola.github.io/SnpEff/"><strong>SnpSift Extract Fields</strong></a></p>

    <div class="Long-Version">

      <blockquote class="hands-on">
        <div id="hands-on-extract-a-tabular-report" class="box-title" aria-label="hands-on box: Extract a tabular report"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Extract a tabular report</div>
        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0"><strong>SnpSift Extract Fields</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.<span class="notranslate">galaxy</span>0</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“Variant input file in VCF format”</em>: Outputs of <strong>SnpSift Filter</strong></li>
              <li><em>“Fields to extract”</em>: <code class="language-plaintext highlighter-rouge">CHROM POS ID REF ALT FILTER</code></li>
            </ul>
          </li>
        </ol>
      </blockquote>

    </div>
  </li>
</ol>

<blockquote class="question">
  <div id="question-8" class="box-title" aria-label="question box: "><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Question</div>

  <p>Now let’s inspect the outputs for <code class="language-plaintext highlighter-rouge">Barcode10</code> tag:</p>

  <ol>
    <li>How many variants were found by <strong>Clair3</strong>?</li>
    <li>How many variants were found after quality filtering?</li>
    <li>What is the Strain identified by the NCBI for the sample?</li>
  </ol>

  <blockquote class="solution">
    <div id="solution-8" class="box-title"><button type="button" aria-controls="solution-8-contents" aria-expanded="true" aria-label="Toggle solution box: "><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"></span> Solution<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>Before filtering: 2,652</li>
      <li>After filtering 2,489</li>
      <li>Strain <a href="https://bacdive.dsmz.de/strain/5117">LT2</a>, can be inferred searching the Chroms. NCBI Reference Sequence: NC_003197.2</li>
    </ol>
  </blockquote>
</blockquote>

<h2 id="consensus-genome-building">Consensus Genome Building</h2>

<p>For further anaylsis we have included one more step in this section, where we build the full genome of our samples.</p>

<p>This consensus genome can be used later to compare and relate samples together based on their full genome. In cases such as SARS-CoV2, it is important to do so in order to discover new outbreaks. In this example of the training, it is not really important to draw a tree of the full genomes of the samples as <em>Salmonella</em> does not have such a speedy outbreak as SARS-CoV2 does. However, we decided to include it in the <span class="notranslate">workflow</span> for any further analysis of the users, if needed.</p>

<p>For this step we run <a href="https://samtools.github.io/bcftools/bcftools.html"><strong>bcftools consensus</strong></a> (<span class="citation"><a href="#Li20092">Li <i>et al.</i> 2009</a></span>).</p>

<div class="Long-Version">

  <blockquote class="hands-on">
    <div id="hands-on-consensus-genome-building" class="box-title" aria-label="hands-on box:  Consensus Genome Building "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Consensus Genome Building</div>
    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/bcftools_consensus/bcftools_consensus/1.15.1+galaxy3" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/bcftools_consensus/bcftools_consensus/1.15.1+galaxy3"><strong>bcftools consensus</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/bcftools_consensus/bcftools_consensus/1.15.1+<span class="notranslate">galaxy</span>3</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“VCF/BCF Data”</em>: Outputs of <strong>SnpSift Filter</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
          <li><em>“Choose the source for the reference genome”</em>: <code class="language-plaintext highlighter-rouge">Use a genome from the history</code>
            <ul>
              <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Reference genome”</em>: <code class="language-plaintext highlighter-rouge">Salmonella_Ref_genome.fna.gz</code></li>
            </ul>
          </li>
        </ul>
      </li>
    </ol>
  </blockquote>

</div>

<blockquote class="question">
  <div id="question-9" class="box-title" aria-label="question box: "><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Question</div>

  <p>Inspect the <strong>bcftools consensus</strong> output for <code class="language-plaintext highlighter-rouge">Barcode11</code> tag</p>

  <ol>
    <li>How many sequences did we get for the sample? What are they?</li>
    <li>Why?</li>
  </ol>

  <blockquote class="solution">
    <div id="solution-9" class="box-title"><button type="button" aria-controls="solution-9-contents" aria-expanded="true" aria-label="Toggle solution box: "><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"></span> Solution<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>We got 2 sequences: the complete genome and the complete <a href="https://www.genome.gov/genetics-glossary/Plasmid">plasmid</a> genome.</li>
      <li>The tool uses the reference genome and the variants found to build the consensus genome of the sample, and the reference genome FASTA file we use includes two sequences a complete one and a plasmid complete one. So the tool constructed both sequences for us to choose from, based on our further analysis.</li>
    </ol>
  </blockquote>
</blockquote>

<h1 id="pathogen-tracking-among-all-samples">Pathogen Tracking among all samples</h1>

<blockquote class="comment">
  <div id="comment-8" class="box-title" aria-label="comment box: "><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden"></span> Comment</div>

  <p>If you did not get your <strong>Gene based pathogenic identification</strong> section output files needed yet or you got an error for some reason, you can go on and download them all or the ones missing from Zenodo so you can start this <span class="notranslate">workflow</span>, please don’t forget to create the collections for them as explained in the pervious hands-on.</p>

  <blockquote class="notranslate hands_on">
    <div id="hands-on-optional-data-upload-1" class="box-title" aria-label="hands-on box: Optional Data upload"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Optional Data upload</div>

    <ol>
      <li>
        <p>Import all tabular and FASTA files needed for this section via link from <a href="https://zenodo.org/record/7593928">Zenodo</a> to the new created history:</p>

        <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/7593928/files/VFs_Barcode10.tabular
https://zenodo.org/record/7593928/files/VFs_Barcode11.tabular
https://zenodo.org/record/7593928/files/VFs_accessions_with_SampleID_Barcode10.tabular
https://zenodo.org/record/7593928/files/VFs_accessions_with_SampleID_Barcode11.tabular
https://zenodo.org/record/7593928/files/VFs_accessions_Barcode10.tabular
https://zenodo.org/record/7593928/files/VFs_accessions_Barcode11.tabular
https://zenodo.org/record/7593928/files/Contigs_Barcode10.fasta
https://zenodo.org/record/7593928/files/Contigs_Barcode11.fasta
</code></pre></div>        </div>

        <!--SNIPPET-->
        <blockquote class="tip">   <div id="tip-importing-via-links-1" class="box-title"><button type="button" aria-controls="tip-importing-via-links-1-contents" aria-expanded="true" aria-label="Toggle tip box: Importing via links"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Importing via links<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Open the <span class="notranslate">Galaxy</span> Upload Manager (<i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-upload</span> on the top-right of the tool panel)</p>   </li>   <li>Select <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>
      </li>
    </ol>

  </blockquote>
</blockquote>

<p>In this last section, we would like to show how to aggregate results and use the results to help tracking pathogenes among samples by:</p>

<ol>
  <li>Drawing a presence-absence heatmap of the identified <strong>VF</strong> genes within all samples to visualize in which samples these genes can be found.</li>
  <li>Drawing a <a href="https://www.sciencedirect.com/topics/medicine-and-dentistry/phylogenetic-tree">phylogenetic tree</a> for each pathogenic gene detected, where we will relate the contigs of the samples together where this gene is found.</li>
</ol>

<p>With these two types of visualizations we can have an overview of all samples and the genes, but also how samples are related to each other, which common pathogenic genes they share. Given the time of the sampling and the location one can easily identify using these graphs, where and when the contamination has occurred among the different samples.</p>

<blockquote class="notranslate hands_on">
  <div id="hands-on-organize-data" class="box-title" aria-label="hands-on box: Organize data"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Organize data</div>

  <ol>
    <li>
      <p>Create a collection named <code class="language-plaintext highlighter-rouge">VFs</code> with <code class="language-plaintext highlighter-rouge">VFs</code> files for both tags</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div id="tip-creating-a-dataset-collection" class="box-title"><button type="button" aria-controls="tip-creating-a-dataset-collection-contents" aria-expanded="true" aria-label="Toggle tip box: Creating a dataset collection"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Creating a dataset collection<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <strong>Operations on multiple datasets</strong> (check box icon) at the top of the history panel <img src="/training-material/topics/galaxy-interface/images/historyItemControls.png" alt="Operations on multiple datasets button" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>For all selected..</strong> and choose <strong>Build dataset list</strong></p>     <p><img src="/training-material/topics/galaxy-interface/images/buildList.png" alt="build list collection menu item" width="15%" /></p>   </li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create List</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>
    </li>
    <li>
      <p>Create a collection named <code class="language-plaintext highlighter-rouge">VFs accessions</code> with <code class="language-plaintext highlighter-rouge">VFs accessions</code> files for both tags</p>
    </li>
    <li>
      <p>Create a collection named <code class="language-plaintext highlighter-rouge">VFs accessions with SampleID</code> with <code class="language-plaintext highlighter-rouge">VFs accessions with SampleID</code> files</p>
    </li>
    <li>
      <p>Create a collection named <code class="language-plaintext highlighter-rouge">Contigs</code> with <code class="language-plaintext highlighter-rouge">Contigs</code> files</p>
    </li>
  </ol>

</blockquote>

<div class="Short-Version">

  <blockquote class="notranslate hands_on">
    <div id="hands-on-all-samples-analysis" class="box-title" aria-label="hands-on box: All Samples Analysis"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: All Samples Analysis</div>

    <ol>
      <li><strong>Import the <span class="notranslate">workflow</span></strong> into <span class="notranslate">Galaxy</span>
        <ul>
          <li>Copy the URL (e.g. via right-click) of <a href="/training-material/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/workflows/nanopore_all_samples_phylogenetic_trees_and_heatmap.ga">this <span class="notranslate">workflow</span></a> or download it to your computer.</li>
          <li>Import the <span class="notranslate">workflow</span> into <span class="notranslate">Galaxy</span></li>
        </ul>

        <!--SNIPPET-->
        <blockquote class="tip">   <div id="tip-importing-a-workflow-3" class="box-title"><button type="button" aria-controls="tip-importing-a-workflow-3-contents" aria-expanded="true" aria-label="Toggle tip box: Importing a workflow"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Importing a <span class="notranslate">workflow</span><span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <em><span class="notranslate">Workflow</span></em> on the top menu bar of <span class="notranslate">Galaxy</span>. You will see a list of all your workflows.</li>   <li>Click on the upload icon <i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-upload</span> at the top-right of the screen</li>   <li>Provide your <span class="notranslate">workflow</span>     <ul>       <li>Option 1: Paste the URL of the <span class="notranslate">workflow</span> into the box labelled <em>“Archived <span class="notranslate">Workflow</span> URL”</em></li>       <li>Option 2: Upload the <span class="notranslate">workflow</span> file in the box labelled <em>“Archived <span class="notranslate">Workflow</span> File”</em></li>     </ul>   </li>   <li>Click the <strong>Import <span class="notranslate">workflow</span></strong> button</li> </ul> </blockquote>
      </li>
      <li>Run <strong><span class="notranslate">Workflow</span> 5: Nanopore Datasets - Reports of All Samples along with Full genomes and VF genes Phylogenetic trees</strong> <i class="fas fa-share-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">workflow</span></span> using the following parameters:
        <ul>
          <li><em>“Send results to a new history”</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Contigs”</em>: <code class="language-plaintext highlighter-rouge">Contigs</code></li>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“VFs”</em>: <code class="language-plaintext highlighter-rouge">VFs</code></li>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“VFs accessions with SampleID”</em>: <code class="language-plaintext highlighter-rouge">VFs accessions with SampleID</code></li>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“VFs accessions”</em>: <code class="language-plaintext highlighter-rouge">VFs accessions</code></li>
        </ul>

        <!--SNIPPET-->
        <blockquote class="tip">   <div id="tip-running-a-workflow-4" class="box-title"><button type="button" aria-controls="tip-running-a-workflow-4-contents" aria-expanded="true" aria-label="Toggle tip box: Running a workflow"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Running a <span class="notranslate">workflow</span><span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <em><span class="notranslate">Workflow</span></em> on the top menu bar of <span class="notranslate">Galaxy</span>. You will see a list of all your workflows.</li>   <li>Click on the <i class="fas fa-play" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">workflow</span>-run</span> (<em>Run <span class="notranslate">workflow</span></em>) button next to your <span class="notranslate">workflow</span></li>   <li>Configure the <span class="notranslate">workflow</span> as needed</li>   <li>Click the <strong>Run <span class="notranslate">Workflow</span></strong> button at the top-right of the screen</li>   <li>You may have to refresh your history to see the queued jobs</li> </ul> </blockquote>
      </li>
    </ol>

  </blockquote>

</div>

<h2 id="heatmap">Heatmap</h2>

<p>A heatmap is one of the visualization techniques that can give you a complete overview of all the samples together and whether or not a certain value exists. In this tutorial, we use the heatmap to visualize all samples aside and check which common bacteria pathogen genes are found in samples and which is only found in one of them.</p>

<p>We use <strong>Heatmap w ggplot</strong> tool along with other tabular manipulating tools to prepare the tabular files.</p>

<div class="Long-Version">

  <ol>
    <li>
      <p>Combine VFs accessions for samples into a table and get 0 or 1 for absence / presence</p>

      <blockquote class="notranslate hands_on">
        <div id="hands-on-heatmap" class="box-title" aria-label="hands-on box:  Heatmap "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Heatmap</div>

        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_multijoin_tool/1.1.1" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_multijoin_tool/1.1.1"><strong>Multi-Join</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/text_processing/tp_multijoin_tool/1.1.1</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File to join”</em>: <code class="language-plaintext highlighter-rouge">VFs accessions with SampleID - Barcode10</code></li>
              <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“add additional file”</em>: <code class="language-plaintext highlighter-rouge">VFs accessions with SampleID - Barcode11</code></li>
              <li><em>“Common key column”</em>: <code class="language-plaintext highlighter-rouge">1</code></li>
              <li><em>“Column with values to preserve”</em>: <code class="language-plaintext highlighter-rouge">Column: 1</code></li>
              <li><em>“Add header line to the output file”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
              <li><em>“Input files contain a header line (as first line)”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
              <li><em>“Ignore duplicated keys”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
            </ul>
          </li>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4"><strong>Replace</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File to process”</em>: output of <strong>Multi-Join</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li>In <em>“Find and Replace”</em>:
                <ul>
                  <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert Find and Replace”</em>
                    <ul>
                      <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">^[^0]\w+</code></li>
                      <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">1</code></li>
                      <li><em>“Find-Pattern is a regular <span class="notranslate">expression</span>”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                      <li><em>“Replace all occurences of the pattern”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                      <li><em>“Ignore first line”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                      <li><em>“Find and Replace text in”</em>: <code class="language-plaintext highlighter-rouge">specific column</code>
                        <ul>
                          <li><em>“in column</em>”: <code class="language-plaintext highlighter-rouge">Column: 2</code></li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4"><strong>Replace</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File to process”</em>: output of <strong>Replace</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li>In <em>“Find and Replace”</em>:
                <ul>
                  <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert Find and Replace”</em>
                    <ul>
                      <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">^[^0]\w+</code></li>
                      <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">1</code></li>
                      <li><em>“Find-Pattern is a regular <span class="notranslate">expression</span>”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                      <li><em>“Replace all occurences of the pattern”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                      <li><em>“Ignore first line”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                      <li><em>“Find and Replace text in”</em>: <code class="language-plaintext highlighter-rouge">specific column</code>
                        <ul>
                          <li><em>“in column</em>”: <code class="language-plaintext highlighter-rouge">Column: 3</code></li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ol>
      </blockquote>
    </li>
    <li>
      <p>Draw heatmap</p>

      <blockquote class="hands-on">
        <div id="hands-on-heatmap-1" class="box-title" aria-label="hands-on box:  Heatmap "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Heatmap</div>
        <ol>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.1.0+galaxy2" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.1.0+galaxy2"><strong>Transpose</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.1.0+<span class="notranslate">galaxy</span>2</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Input tabular dataset”</em>: output of <strong>Replace</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
            </ul>
          </li>
          <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_heatmap/ggplot2_heatmap/3.4.0+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_heatmap/ggplot2_heatmap/3.4.0+galaxy0"><strong>Heatmap w ggplot</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/ggplot2_heatmap/ggplot2_heatmap/3.4.0+<span class="notranslate">galaxy</span>0</span></span>  with the following parameters:
            <ul>
              <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Select table”</em>: output of <strong>Transpose</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li><em>“Select input dataset options”</em>: <code class="language-plaintext highlighter-rouge">Dataset with header and row names</code>
                <ul>
                  <li><em>“Select column, for row names”</em>: <code class="language-plaintext highlighter-rouge">Column: 1</code></li>
                  <li><em>“Sample names orientation”</em>: <code class="language-plaintext highlighter-rouge">horizontal</code></li>
                </ul>
              </li>
              <li><em>“Plot title”</em>: <code class="language-plaintext highlighter-rouge">All Samples Common VFs Heatmap</code></li>
              <li>In <em>“Output Options”</em>:
                <ul>
                  <li><em>“width of output”</em>: <code class="language-plaintext highlighter-rouge">15.0</code></li>
                  <li><em>“height of output”</em>: <code class="language-plaintext highlighter-rouge">17.0</code></li>
                </ul>
              </li>
            </ul>
          </li>
        </ol>
      </blockquote>
    </li>
  </ol>

</div>

<blockquote class="question">
  <div id="question-10" class="box-title" aria-label="question box: "><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Question</div>

  <p>Now let’s see how your heatmap looks like, you can zoom-in and out in your <span class="notranslate">Galaxy</span> history.</p>

  <p><img src="./images/heatmap.png" alt="Heatmap. " loading="lazy" /></p>

  <ol>
    <li>Mention three of the common bacterial pathogen genes found in both samples.</li>
    <li>How can the differences in the found <strong>VF</strong> bacteria pathogen genes between the two samples be interpreted?</li>
  </ol>

  <blockquote class="solution">
    <div id="solution-10" class="box-title"><button type="button" aria-controls="solution-10-contents" aria-expanded="true" aria-label="Toggle solution box: "><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"></span> Solution<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>A lot of bacteria pathogen <strong>VF</strong> gene products identified by the <strong>VFDB</strong> are common in both samples, three of them are with the following accession number: <strong>NP_461810</strong>, <strong>NP_461809</strong> and <strong>NP_459541</strong></li>
      <li><strong>AAG03023</strong> is only found in <code class="language-plaintext highlighter-rouge">Barcode10</code> sample and <strong>NP_460360</strong> is only found in <code class="language-plaintext highlighter-rouge">Barcode11</code> sample</li>
      <li>
        <p>Both samples were spiked with the same pathogen species, <em>S. enterica</em>, but not the same strain:</p>

        <ul>
          <li><code class="language-plaintext highlighter-rouge">Barcode10_Spike2</code> sample is spiked with <em>S. enterica subsp. enterica</em> strain</li>
          <li><code class="language-plaintext highlighter-rouge">Barcode11_Spike2b</code> sample is spiked with <em>S. enterica subsp. houtenae</em> strain.</li>
        </ul>

        <p>This can be the main cause of the big similarities and the few differences of the bacteria pathogen <strong>VF</strong> gene products found between both of the two samples. 
Other factors such as the <strong>time</strong> and <strong>location</strong> of the sampling may cause other differences. By knowing the metadata of the samples inputted for the workflows in real life we can understand what actually happened. We can have samples with no pathogen found then we start detecting genes from the 7th or 8th sample, then we can identify where and when the pathogen entered the host, and stop the cause of that</p>
      </li>
    </ol>

  </blockquote>
</blockquote>

<h2 id="phylogenetic-tree-building">Phylogenetic Tree building</h2>

<p>Phylogenetic trees are nice ways to track all the bacterial pathogen genes one by one in all samples. So we will have a tree for every found gene, this tree will indicate which contigs the gene is found in all samples and relating these contigs together based on their topology. With such trees we can identify on which location of the sequences from the sample genome the pathogentic gene is found and whether it is at the same or a different location as the other samples. We can also see how many samples have these genes in common and accordingly track our contamination.</p>

<p>For the phylogenetic trees, for each bacteria pathogen gene found in the samples we use <strong>ClustalW</strong> (<span class="citation"><a href="#Larkin2007">Larkin <i>et al.</i> 2007</a></span>) for <a href="https://www.sciencedirect.com/topics/medicine-and-dentistry/multiple-sequence-alignment">Multiple Sequence Alignment (MSA)</a> needed before constructing a phylogenetic tree, for the tree itself we use <strong>FASTTREE</strong> and <strong>Newick Display</strong> (<span class="citation"><a href="#Dress2008">Dress <i>et al.</i> 2008</a></span>) to visualize it.</p>

<div class="Long-Version">

  <p>To get the sequence to align, we need to extract the sequences of the VFs in the contigs:</p>

  <blockquote class="hands-on">
    <div id="hands-on-extract-the-sequences-of-the-vfs" class="box-title" aria-label="hands-on box:  Extract the sequences of the VFs "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Extract the sequences of the VFs</div>
    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0" title="Tested with toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0"><strong>Collapse Collecction</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Collection of files to collapse into single dataset”</em>: <code class="language-plaintext highlighter-rouge">Contigs</code></li>
          <li><em>“Prepend File name”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        </ul>
      </li>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0" title="Tested with toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0"><strong>Collapse Collection</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Collection of files to collapse into single dataset”</em>: <code class="language-plaintext highlighter-rouge">VFs</code></li>
          <li><em>“Keep one header line”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
          <li><em>“Prepend File name”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        </ul>
      </li>
      <li><span class="tool" data-tool="Remove beginning1" title="Tested with Remove beginning1"><strong>Remove beginning</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: Remove beginning1</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“from”</em>: output of 2nd <strong>Collapse Collection</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        </ul>
      </li>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/split_file_on_column/tp_split_on_column/0.6" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/split_file_on_column/tp_split_on_column/0.6"><strong>Split by group</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/split_file_on_column/tp_split_on_column/0.6</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File to split”</em>: output of <strong>Remove beginning</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
          <li><em>“on column”</em>: <code class="language-plaintext highlighter-rouge">Column: 13</code></li>
          <li><em>“Include header in splits?”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        </ul>
      </li>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/peterjc/seq_filter_by_id/seq_filter_by_id/0.2.7" title="Tested with toolshed.g2.bx.psu.edu/repos/peterjc/seq_filter_by_id/seq_filter_by_id/0.2.7"><strong>Filter sequences by ID</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/peterjc/seq_filter_by_id/seq_filter_by_id/0.2.7</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Sequence file to be filtered”</em>: output of 1st <strong>Collapse Collection</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
          <li><em>“Filter using the ID list from”</em>: <code class="language-plaintext highlighter-rouge">tabular file</code>
            <ul>
              <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Tabular file containing sequence identifiers”</em>: output of <strong>Split by group</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li><em>“Column(s) containing sequence identifiers”</em>: <code class="language-plaintext highlighter-rouge">Column: 2</code></li>
            </ul>
          </li>
          <li><em>“Output positive matches, negative matches, or both?”</em>: <code class="language-plaintext highlighter-rouge">Just positive matches (ID on list), as a single file</code></li>
        </ul>
      </li>
    </ol>

  </blockquote>

  <p>We can now run multiple sequence alignment, build the trees for each VF and display them.</p>

  <blockquote class="hands-on">
    <div id="hands-on-phylogenetic-tree-building" class="box-title" aria-label="hands-on box:  Phylogenetic Tree building "><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on:  Phylogenetic Tree building</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/clustalw/clustalw/2.1+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/devteam/clustalw/clustalw/2.1+galaxy1"><strong>ClustalW</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/devteam/clustalw/clustalw/2.1+<span class="notranslate">galaxy</span>1</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“FASTA file”</em>: output of <strong>Filter sequences by ID</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
          <li><em>“Data type”</em>: <code class="language-plaintext highlighter-rouge"><span class="notranslate">DNA</span> nucleotide sequences</code></li>
          <li><em>“Output alignment format”</em>: <code class="language-plaintext highlighter-rouge">FASTA format</code></li>
          <li><em>“Output complete alignment (or specify part to output)”</em>: <code class="language-plaintext highlighter-rouge">Complete alignment</code></li>
        </ul>
      </li>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/fasttree/fasttree/2.1.10+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/fasttree/fasttree/2.1.10+galaxy1"><strong>FASTTREE</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/fasttree/fasttree/2.1.10+<span class="notranslate">galaxy</span>1</span></span>  with the following parameters:
        <ul>
          <li><em>“Aligned sequences file (FASTA or Phylip format)”</em>: <code class="language-plaintext highlighter-rouge">fasta</code>
            <ul>
              <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“FASTA file”</em>: output of <strong>ClustalW</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
              <li><em>“Set starting tree(s)”</em>: <code class="language-plaintext highlighter-rouge">No starting trees</code></li>
            </ul>
          </li>
          <li><em>“Protein or nucleotide alignment”</em>: <code class="language-plaintext highlighter-rouge">Nucleotide</code></li>
        </ul>
      </li>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/newick_utils/newick_display/1.6+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/newick_utils/newick_display/1.6+galaxy1"><strong>Newick Display</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/newick_utils/newick_display/1.6+<span class="notranslate">galaxy</span>1</span></span>  with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Newick file”</em>: output of <strong>FASTTREE</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
          <li><em>“Branch support”</em>: <code class="language-plaintext highlighter-rouge">Hide branch support</code></li>
          <li><em>“Branch length”</em>: <code class="language-plaintext highlighter-rouge">Hide branch length</code></li>
          <li><em>“Image width”</em>: <code class="language-plaintext highlighter-rouge">2000</code></li>
        </ul>
      </li>
    </ol>
  </blockquote>

</div>

<blockquote class="question">
  <div id="question-11" class="box-title" aria-label="question box: "><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Question</div>

  <p>Now let’s see how your trees for the bacteria pathogen gene with accession IDs: <strong>AAF98391</strong>, <strong>NP_249099</strong> and <strong>NP_460111</strong> look like. To access that go to the output of Newick</p>

  <ol>
    <li>In which samples and contigs is gene <strong>BAA94855</strong> found?</li>
    <li>In which samples and contigs is gene <strong>NP_249099</strong> found?</li>
    <li>In which samples and contigs is gene <strong>NP_461819</strong> found?</li>
  </ol>

  <blockquote class="solution">
    <div id="solution-11" class="box-title"><button type="button" aria-controls="solution-11-contents" aria-expanded="true" aria-label="Toggle solution box: "><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"></span> Solution<span role="button" class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>
        <p>In the <code class="language-plaintext highlighter-rouge">Barcode10</code> sample only: Contigs 109 and 66</p>

        <p><img src="./images/BAA94855_Part_of_tree.png" alt="BAA94855_Part_of_tree. " loading="lazy" /></p>
      </li>
      <li>
        <p>In the <code class="language-plaintext highlighter-rouge">Barcode11</code> sample only: Contig 2</p>

        <p><img src="./images/NP_249099_Part_of_tree.png" alt="NP_249099_Part_of_tree. " loading="lazy" /></p>
      </li>
      <li>
        <p>In both samples; Contig 121 of <code class="language-plaintext highlighter-rouge">Barcode10</code> and Contig 1 of <code class="language-plaintext highlighter-rouge">Barcode11</code></p>

        <p><img src="./images/NP_461819_Part_of_tree.png" alt="NP_461819_Part_of_tree. " loading="lazy" /></p>
      </li>
    </ol>

  </blockquote>
</blockquote>

<h1 id="conclusion">Conclusion</h1>

<p>In this tutorial, we have tried the <span class="notranslate">workflow</span> designed to detect and track pathogens in our food and drinks. Through out the full <span class="notranslate">workflow</span> we used our Nanopore sequenced datasets from Biolytix and analyzed it, found the pathogens and tracked it. This approach can be summarized with the following scheme:</p>

<figure id="figure-2"><img src="./images/FoodBorne-Workflow-updated.png" alt="Foodborne full workflow big picture. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figure 2:</span> The complete picture of the <span class="notranslate">workflow</span> used in this training highlighting, not all, but the most important steps done in 5 sub-workflows explained in the training</figcaption></figure>



                

                <h1>Frequently Asked Questions</h1>
                Have questions about this tutorial? Check out the  <a href="/training-material/topics/metagenomics/faqs/">FAQ page for the Metagenomics topic</a> to see if your question is listed there.
                If not, please ask your question on the <a href="https://gitter.im/Galaxy-Training-Network/Lobby">GTN Gitter Channel</a> or the
                <a href="https://help.galaxyproject.org">Galaxy Help Forum</a>

                

                
                <h1 data-toc-skip>Useful literature</h1>
                <p>Further information, including links to documentation and original publications, regarding the tools, analysis techniques and the interpretation of results described in this tutorial can be found <a href="/training-material/topics/metagenomics#references">here</a>.</p>
                


                
                <h1 id="bibliography">References</h1>
                <ol class="bibliography"><li id="Larkin2007">Larkin, M. A., G. Blackshields, N. P. Brown, R. Chenna, P. A. McGettigan <i>et al.</i>, 2007 <b>Clustal W and Clustal X version 2.0</b>. Bioinformatics 23: 2947–2948. <a href="https://doi.org/10.1093/bioinformatics/btm404">10.1093/bioinformatics/btm404</a></li>
<li id="Dress2008">Dress, A. W. M., C. Flamm, G. Fritzsch, S. Gr\~ A1\textfractionsolidus4newald, M. Kruspe <i>et al.</i>, 2008 <b>Noisy: Identification of problematic columns in multiple sequence alignments</b>. Algorithms for Molecular Biology 3: 7. <a href="https://doi.org/10.1186/1748-7188-3-7">10.1186/1748-7188-3-7</a></li>
<li id="Li20092">Li, H., B. Handsaker, A. Wysoker, T. Fennell, J. Ruan <i>et al.</i>, 2009 <b>The Sequence Alignment/Map format and SAMtools</b>. Bioinformatics 25: 2078–2079. <a href="https://doi.org/10.1093/bioinformatics/btp352">10.1093/bioinformatics/btp352</a></li>
<li id="sentericaachtman2"><b>Multilocus Sequence Typing as a Replacement for Serotyping in Salmonella enterica</b>, 2012 PLOS Pathogens 8: e1002776. https://journals.plos.org/plospathogens/article/file?id=10.1371/journal.ppat.1002776&type=printable. <a href="https://doi.org/10.1371/journal.ppat.1002776">10.1371/journal.ppat.1002776</a> <a href="https://app.dimensions.ai/details/publication/pub.1037561963">https://app.dimensions.ai/details/publication/pub.1037561963</a></li>
<li id="Cingolani2012">Cingolani, P., V. M. Patel, M. Coon, T. Nguyen, S. J. Land <i>et al.</i>, 2012 <b>Using Drosophila melanogaster as a Model for Genotoxic Chemical Mutational Studies with a New Program, SnpSift</b>. Frontiers in Genetics 3: <a href="https://doi.org/10.3389/fgene.2012.00035">10.3389/fgene.2012.00035</a></li>
<li id="Cock2013">Cock, P. J. A., B. A. Grüning, K. Paszkiewicz, and L. Pritchard, 2013 <b>Galaxy tools and workflows for sequence analysis with applications in molecular plant pathology</b>. PeerJ 1: e167. <a href="https://doi.org/10.7717/peerj.167">10.7717/peerj.167</a></li>
<li id="Wood2014">Wood, D. E., and S. L. Salzberg, 2014 <b>Kraken: ultrafast metagenomic sequence classification using exact alignments</b>. Genome Biology 15: R46. <a href="https://doi.org/10.1186/gb-2014-15-3-r46">10.1186/gb-2014-15-3-r46</a></li>
<li id="Wick2015">Wick, R. R., M. B. Schultz, J. Zobel, and K. E. Holt, 2015 <b>Bandage: interactive visualization ofde novogenome assemblies: Fig. 1.</b> Bioinformatics 31: 3350–3352. <a href="https://doi.org/10.1093/bioinformatics/btv383">10.1093/bioinformatics/btv383</a></li>
<li id="Ewels2016">Ewels, P., M. Magnusson, M. Käller, and S. Lundin, 2016 <b>MultiQC: summarize analysis results for multiple tools and samples in a single report</b>. Bioinformatics 32: 3047–3048. <a href="https://doi.org/10.1093/bioinformatics/btw354">10.1093/bioinformatics/btw354</a></li>
<li id="Li2017Minimap2">Li, H., 2017 <b>Minimap2: fast pairwise alignment for long nucleotide sequences</b>. <i>https://arxiv.org/abs/1708.01492</i>. <a href="https://doi.org/10.1093/bioinformatics/bty191">10.1093/bioinformatics/bty191</a></li>
<li id="Chen2018">Chen, C.-H., T. Xiao, H. Xu, P. Jiang, C. A. Meyer <i>et al.</i>, 2018 <b>Improved design and analysis of CRISPR knockout screens</b> (J. Wren, Ed.). Bioinformatics 34: 4095–4101. <a href="https://doi.org/10.1093/bioinformatics/bty450">10.1093/bioinformatics/bty450</a></li>
<li id="Johnson2018">Johnson, J. E., P. Kumar, C. Easterly, M. Esler, S. Mehta <i>et al.</i>, 2018 <b>Improve your Galaxy text life: The Query Tabular Tool</b>. F1000Research 7: 1604. <a href="https://doi.org/10.12688/f1000research.16450.2">10.12688/f1000research.16450.2</a></li>
<li id="flye">Kolmogorov, M., D. Bickhart, B. Behsaz, A. Gurevich, M. Rayko <i>et al.</i>, 2020 <b>metaFlye: scalable long-read metagenome assembly using repeat graphs</b>. Nature Methods 17: 1–8. <a href="https://doi.org/10.1038/s41592-020-00971-x">10.1038/s41592-020-00971-x</a></li>
<li id="CIUFFREDA20211497">Ciuffreda, L., H. Rodríguez-Pérez, and C. Flores, 2021 <b>Nanopore sequencing and its application to the study of microbial communities</b>. Computational and Structural Biotechnology Journal 19: 1497–1511. <a href="https://doi.org/https://doi.org/10.1016/j.csbj.2021.02.020">https://doi.org/10.1016/j.csbj.2021.02.020</a> <a href="https://www.sciencedirect.com/science/article/pii/S2001037021000714">https://www.sciencedirect.com/science/article/pii/S2001037021000714</a></li>
<li id="Zheng2021">Zheng, Z., S. Li, J. Su, A. W.-S. Leung, T.-W. Lam <i>et al.</i>, 2021 <b>Symphonizing pileup and full-alignment for deep learning-based long-read variant calling</b>. <a href="https://doi.org/10.1038/s43588-022-00387-x">10.1038/s43588-022-00387-x</a></li></ol>
                

                

                <h1>Feedback</h1>
                <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452">how it went</a>.
                <br>Did you use this material as a learner or student? Click the form below to leave feedback.<i class="fas fa-hand-point-down"></i>
                </p>

                <div id="feedback-button">
                    <img src="/training-material/shared/images/feedback.png" title="Click to activate" alt="Click here to load Google feedback frame" />
                </div>
                <div id="feedback-form">
                </div>
                <script type="text/javascript">
                    (function (window, document) {
                        function onDocumentReady(fn) {
                            if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
                                fn();
                            } else {
                                document.addEventListener('DOMContentLoaded', fn);
                            }
                        }

                        onDocumentReady(function () {
                            $("#feedback-button").click(function(evt){
                                var e = $(evt.target)
                                e.hide();

                                $("#feedback-form").html(`
                                    <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=Pathogen detection from (direct Nanopore) sequencing data using Galaxy - Foodborne Edition (Metagenomics)">Loading...</iframe>
                                `)
                            })
                        });
                    })(window, document);
                </script>

                <h1>Citing this Tutorial</h1>
                <p>
                    <ol>
                        <li id="citation-text">
                            Bérénice Batut, Engy Nasr,  <b>Pathogen detection from (direct Nanopore) sequencing data using Galaxy - Foodborne Edition (Galaxy Training Materials)</b>. <a href="https://training.galaxyproject.org/training-material/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html">https://training.galaxyproject.org/training-material/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html</a> Online; accessed TODAY
                        </li>
                        <li>
                        Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                        </li>
                    </ol>
                </p>

                <!-- collapsible boxcontaining the BibTeX-formatted citation -->
                <blockquote class="details">

                  <div id="citation-bibtex" class="box-title">
                    <button type="button" aria-controls="citation-bibtex" aria-expanded="false" aria-label="Toggle details box: BibTeX for citing this tutorial">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> BibTeX<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>
                   <p style="display: none;">

                   <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">


<code id="citation-code">@misc{metagenomics-pathogen-detection-from-nanopore-foodborne-data,
author = "Bérénice Batut and Engy Nasr",
title = "Pathogen detection from (direct Nanopore) sequencing data using Galaxy - Foodborne Edition (Galaxy Training Materials)",
year = "",
month = "",
day = ""
url = "\url{https://training.galaxyproject.org/training-material/topics/metagenomics/tutorials/pathogen-detection-from-nanopore-foodborne-data/tutorial.html}",
note = "[Online; accessed TODAY]"
}
@article{Hiltemann_2023,
	doi = {10.1371/journal.pcbi.1010752},
	url = {https://doi.org/10.1371%2Fjournal.pcbi.1010752},
	year = 2023,
	month = {jan},
	publisher = {Public Library of Science ({PLoS})},
	volume = {19},
	number = {1},
	pages = {e1010752},
	author = {Saskia Hiltemann and Helena Rasche and Simon Gladman and Hans-Rudolf Hotz and Delphine Larivi{\`{e}}re and Daniel Blankenberg and Pratik D. Jagtap and Thomas Wollmann and Anthony Bretaudeau and Nadia Gou{\'{e}} and Timothy J. Griffin and Coline Royaux and Yvan Le Bras and Subina Mehta and Anna Syme and Frederik Coppens and Bert Droesbeke and Nicola Soranzo and Wendi Bacon and Fotis Psomopoulos and Crist{\'{o}}bal Gallardo-Alba and John Davis and Melanie Christine Föll and Matthias Fahrner and Maria A. Doyle and Beatriz Serrano-Solano and Anne Claire Fouilloux and Peter van Heusden and Wolfgang Maier and Dave Clements and Florian Heyl and Björn Grüning and B{\'{e}}r{\'{e}}nice Batut and},
	editor = {Francis Ouellette},
	title = {Galaxy Training: A powerful framework for teaching!},
	journal = {PLoS Comput Biol} Computational Biology}
}
</code>
                   </pre></div></div>
                   </p>
                </blockquote>

                
                

                


<script type="text/javascript">
// update the date on load, or leave fallback of 'today'
d = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", d.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", d.toDateString());
</script>

                <i class="far fa-thumbs-up" aria-hidden="true"></i> Congratulations on successfully completing this tutorial!

                

                

            </div>
        </div>
    </div>
</section>
<br/>
<br/>
<br/>

        </div>
        
        <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
        <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
        <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
        <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="/training-material/assets/js/bootstrap-toc.min.js"></script>
        <script type="text/javascript" src="/training-material/assets/js/main.js"></script>
        <script type="text/javascript" src="/training-material/assets/js/clipboard.min.js"></script>
        <script type="text/javascript">
        var snippets=document.querySelectorAll('div.highlight');
        [].forEach.call(snippets,function(snippet){
            snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet><i class="fa fa-copy"></i>&nbsp;Copy</button>');
        });

        var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
            target:function(trigger){return trigger.nextElementSibling;
        }});
        </script>
        

        <script type="text/javascript">
            if(window.location.hostname === "galaxyproject.github.io") {
                // Redirect
                var redirect = "https://training.galaxyproject.org" + window.location.pathname + window.location.search;
                $('div.container.main-content').prepend("<div class='alert alert-warning'><strong>Note: </strong>This content has a new home at <a href=\"" + redirect + "\">" + redirect + "</a>, which you will be redirected to in 5 seconds.</div>");

                window.setTimeout(function(){
                    window.location.href = redirect;
                }, 5000)

            }
        </script>
    </body>
</html>
